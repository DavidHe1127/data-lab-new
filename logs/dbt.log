[0m14:23:52.125998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108767af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d93d0>]}


============================== 14:23:52.129017 | 17b1b4d0-d520-4a8e-9856-ed437b81f673 ==============================
[0m14:23:52.129017 [info ] [MainThread]: Running with dbt=1.10.18
[0m14:23:52.129530 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'log_cache_events': 'False', 'empty': 'None', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80'}
[0m14:23:52.269025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d3b50>]}
[0m14:23:52.296757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109776ac0>]}
[0m14:23:52.298411 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:23:52.355054 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m14:23:52.425449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:52.425688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:52.429303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m14:23:52.438462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da1130>]}
[0m14:23:52.472954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m14:23:52.475990 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m14:23:52.491941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da9c70>]}
[0m14:23:52.492259 [info ] [MainThread]: Found 3 seeds, 456 macros
[0m14:23:52.492447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d90eb0>]}
[0m14:23:52.493161 [info ] [MainThread]: 
[0m14:23:52.493322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:52.493450 [info ] [MainThread]: 
[0m14:23:52.493705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:23:52.496216 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m14:23:52.605765 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m14:23:52.606059 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m14:23:52.606235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:52.611597 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:23:52.612200 [debug] [ThreadPool]: On list_lab: Close
[0m14:23:52.612596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main)
[0m14:23:52.612917 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main"
"
[0m14:23:52.616844 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m14:23:52.617050 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m14:23:52.617180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:52.617654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:23:52.618260 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m14:23:52.618393 [debug] [ThreadPool]: On create_lab_main: BEGIN
[0m14:23:52.618593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:23:52.618706 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m14:23:52.618818 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
    
        create schema if not exists "lab"."main"
    
[0m14:23:52.619014 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:23:52.619335 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m14:23:52.619464 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m14:23:52.619580 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m14:23:52.619756 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:23:52.619900 [debug] [ThreadPool]: On create_lab_main: Close
[0m14:23:52.620415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main, now list_lab_main)
[0m14:23:52.623204 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m14:23:52.623365 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m14:23:52.623484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:52.623707 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:23:52.623829 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m14:23:52.623961 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m14:23:52.627989 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:23:52.628533 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m14:23:52.629489 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m14:23:52.629659 [debug] [ThreadPool]: On list_lab_main: Close
[0m14:23:52.630197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072151f0>]}
[0m14:23:52.630417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:52.630550 [debug] [MainThread]: On master: BEGIN
[0m14:23:52.630684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:52.630947 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:23:52.631057 [debug] [MainThread]: On master: COMMIT
[0m14:23:52.631163 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:52.631268 [debug] [MainThread]: On master: COMMIT
[0m14:23:52.631431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:23:52.631541 [debug] [MainThread]: On master: Close
[0m14:23:52.632768 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_customers
[0m14:23:52.633000 [info ] [Thread-1  ]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m14:23:52.633205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now seed.data_lab_new.raw_customers)
[0m14:23:52.633396 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_customers
[0m14:23:52.633532 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_customers
[0m14:23:52.647372 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m14:23:52.647670 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: BEGIN
[0m14:23:52.647835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:52.648229 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.648413 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m14:23:52.648551 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_customers"} */
truncate table "lab"."main"."raw_customers"
[0m14:23:52.648921 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.654087 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m14:23:52.654245 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: 
          COPY "lab"."main"."raw_customers" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:23:52.656360 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m14:23:52.659244 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_customers"
[0m14:23:52.667354 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: COMMIT
[0m14:23:52.667692 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m14:23:52.667841 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: COMMIT
[0m14:23:52.668686 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:23:52.669579 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: Close
[0m14:23:52.670459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db3370>]}
[0m14:23:52.670687 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.04s]
[0m14:23:52.670935 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_customers
[0m14:23:52.671104 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_orders
[0m14:23:52.671343 [info ] [Thread-1  ]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m14:23:52.671540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_customers, now seed.data_lab_new.raw_orders)
[0m14:23:52.671694 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_orders
[0m14:23:52.671843 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_orders
[0m14:23:52.677089 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m14:23:52.677291 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: BEGIN
[0m14:23:52.677428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:52.677728 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.677890 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m14:23:52.678032 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_orders"} */
truncate table "lab"."main"."raw_orders"
[0m14:23:52.678333 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.678947 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m14:23:52.679092 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: 
          COPY "lab"."main"."raw_orders" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:23:52.682651 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m14:23:52.683232 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_orders"
[0m14:23:52.686634 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: COMMIT
[0m14:23:52.686802 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m14:23:52.686936 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: COMMIT
[0m14:23:52.687364 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.687724 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: Close
[0m14:23:52.688030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b29d0>]}
[0m14:23:52.688290 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 99[0m in 0.02s]
[0m14:23:52.688537 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_orders
[0m14:23:52.688711 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_payments
[0m14:23:52.688964 [info ] [Thread-1  ]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m14:23:52.689160 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_orders, now seed.data_lab_new.raw_payments)
[0m14:23:52.689315 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_payments
[0m14:23:52.689454 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_payments
[0m14:23:52.693299 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m14:23:52.693478 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: BEGIN
[0m14:23:52.693611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:52.693902 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.694048 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m14:23:52.694181 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_payments"} */
truncate table "lab"."main"."raw_payments"
[0m14:23:52.694455 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.694945 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m14:23:52.695090 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: 
          COPY "lab"."main"."raw_payments" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:23:52.696183 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m14:23:52.696458 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_payments"
[0m14:23:52.699142 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: COMMIT
[0m14:23:52.699350 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m14:23:52.699498 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: COMMIT
[0m14:23:52.700011 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m14:23:52.700371 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: Close
[0m14:23:52.700661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b1b4d0-d520-4a8e-9856-ed437b81f673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27b940>]}
[0m14:23:52.700917 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file main.raw_payments ................................... [[32mINSERT 113[0m in 0.01s]
[0m14:23:52.701159 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_payments
[0m14:23:52.701675 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:52.701812 [debug] [MainThread]: On master: BEGIN
[0m14:23:52.701921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:52.702159 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:23:52.702284 [debug] [MainThread]: On master: COMMIT
[0m14:23:52.702404 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:52.702517 [debug] [MainThread]: On master: COMMIT
[0m14:23:52.702692 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:23:52.702826 [debug] [MainThread]: On master: Close
[0m14:23:52.702984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:52.703088 [debug] [MainThread]: Connection 'seed.data_lab_new.raw_payments' was properly closed.
[0m14:23:52.703217 [info ] [MainThread]: 
[0m14:23:52.703352 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:23:52.703756 [debug] [MainThread]: Command end result
[0m14:23:52.721965 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m14:23:52.725703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m14:23:52.736607 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m14:23:52.736949 [info ] [MainThread]: 
[0m14:23:52.737365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:52.737546 [info ] [MainThread]: 
[0m14:23:52.737815 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:23:52.739397 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.6570843, "process_in_blocks": "0", "process_kernel_time": 0.221268, "process_mem_max_rss": "144916480", "process_out_blocks": "0", "process_user_time": 1.047295}
[0m14:23:52.739642 [debug] [MainThread]: Command `dbt seed` succeeded at 14:23:52.739597 after 0.66 seconds
[0m14:23:52.739837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108767af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc22b0>]}
[0m14:23:52.740030 [debug] [MainThread]: Flushing usage events
[0m14:23:53.890164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:05.134568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108467d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094df880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094df6a0>]}


============================== 16:23:05.145092 | 32bc11df-7c99-4fb8-a3dd-36d0b13a9f81 ==============================
[0m16:23:05.145092 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:23:05.145473 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'invocation_command': 'dbt compile', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True'}
[0m16:23:05.552538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32bc11df-7c99-4fb8-a3dd-36d0b13a9f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e45700>]}
[0m16:23:05.576397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32bc11df-7c99-4fb8-a3dd-36d0b13a9f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f24f0>]}
[0m16:23:05.578955 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:23:05.725083 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:23:06.035455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:06.036243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:06.046333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:23:06.063881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32bc11df-7c99-4fb8-a3dd-36d0b13a9f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa3130>]}
[0m16:23:06.102840 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:23:06.105809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:23:06.170067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32bc11df-7c99-4fb8-a3dd-36d0b13a9f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a718b0>]}
[0m16:23:06.170542 [info ] [MainThread]: Found 3 seeds, 456 macros
[0m16:23:06.170840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32bc11df-7c99-4fb8-a3dd-36d0b13a9f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7b760>]}
[0m16:23:06.171861 [info ] [MainThread]: 
[0m16:23:06.172142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:06.172363 [info ] [MainThread]: 
[0m16:23:06.172739 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:23:06.176396 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab_main'
[0m16:23:06.865566 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:23:06.866406 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:23:06.866832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:06.881618 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m16:23:06.882463 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:23:06.883412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:06.883818 [debug] [MainThread]: Connection 'list_lab_main' was properly closed.
[0m16:23:06.884399 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/src/../database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 11378) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m16:23:06.887212 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.844224, "process_in_blocks": "0", "process_kernel_time": 0.526197, "process_mem_max_rss": "130121728", "process_out_blocks": "0", "process_user_time": 1.732195}
[0m16:23:06.887745 [debug] [MainThread]: Command `dbt compile` failed at 16:23:06.887645 after 1.84 seconds
[0m16:23:06.888154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108467d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d7370>]}
[0m16:23:06.888547 [debug] [MainThread]: Flushing usage events
[0m16:23:08.096777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:22.015268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac738e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac73700>]}


============================== 16:23:22.017700 | 2283dd24-d475-4e80-afff-d62a987d3141 ==============================
[0m16:23:22.017700 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:23:22.017977 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'invocation_command': 'dbt compile', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m16:23:22.132461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2283dd24-d475-4e80-afff-d62a987d3141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b52b0>]}
[0m16:23:22.156661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2283dd24-d475-4e80-afff-d62a987d3141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac39910>]}
[0m16:23:22.158009 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:23:22.208036 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:23:22.280106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:22.280295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:22.283464 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:23:22.291760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2283dd24-d475-4e80-afff-d62a987d3141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b239fa0>]}
[0m16:23:22.331331 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:23:22.333751 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:23:22.353541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2283dd24-d475-4e80-afff-d62a987d3141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2036d0>]}
[0m16:23:22.353788 [info ] [MainThread]: Found 3 seeds, 456 macros
[0m16:23:22.353964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2283dd24-d475-4e80-afff-d62a987d3141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b151b80>]}
[0m16:23:22.354558 [info ] [MainThread]: 
[0m16:23:22.354740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:22.354884 [info ] [MainThread]: 
[0m16:23:22.355126 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:23:22.357589 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab_main'
[0m16:23:22.456203 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:23:22.456434 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:23:22.456577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:22.461602 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:23:22.461788 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:23:22.461936 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:23:22.466411 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:23:22.466952 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:23:22.474580 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:23:22.474753 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:23:22.475056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2283dd24-d475-4e80-afff-d62a987d3141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ba130>]}
[0m16:23:22.476199 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_customers
[0m16:23:22.476394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now seed.data_lab_new.raw_customers)
[0m16:23:22.476646 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_customers
[0m16:23:22.480005 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_customers
[0m16:23:22.480329 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_customers
[0m16:23:22.480497 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_orders
[0m16:23:22.480688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_customers, now seed.data_lab_new.raw_orders)
[0m16:23:22.480858 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_orders
[0m16:23:22.481666 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_orders
[0m16:23:22.481938 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_orders
[0m16:23:22.482099 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_payments
[0m16:23:22.482272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_orders, now seed.data_lab_new.raw_payments)
[0m16:23:22.482427 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_payments
[0m16:23:22.483256 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_payments
[0m16:23:22.483516 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_payments
[0m16:23:22.483864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:22.483995 [debug] [MainThread]: Connection 'seed.data_lab_new.raw_payments' was properly closed.
[0m16:23:22.484334 [debug] [MainThread]: Command end result
[0m16:23:22.496758 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:23:22.497940 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:23:22.502917 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:23:22.504162 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.5233989, "process_in_blocks": "0", "process_kernel_time": 0.205901, "process_mem_max_rss": "135561216", "process_out_blocks": "0", "process_user_time": 0.884317}
[0m16:23:22.504359 [debug] [MainThread]: Command `dbt compile` succeeded at 16:23:22.504323 after 0.52 seconds
[0m16:23:22.504532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae71910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2095e0>]}
[0m16:23:22.504702 [debug] [MainThread]: Flushing usage events
[0m16:23:23.542564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:49.188560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ff8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ff700>]}


============================== 16:25:49.191149 | cff9e6a9-0a4a-49b9-b8af-7fce8db8726f ==============================
[0m16:25:49.191149 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:25:49.191425 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'invocation_command': 'dbt compile'}
[0m16:25:49.304607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff9e6a9-0a4a-49b9-b8af-7fce8db8726f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f422b0>]}
[0m16:25:49.328585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cff9e6a9-0a4a-49b9-b8af-7fce8db8726f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c5910>]}
[0m16:25:49.329922 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:25:49.379421 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:25:49.456276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:25:49.456526 [debug] [MainThread]: Partial parsing: added file: data_lab_new://models/silver_transform.sql
[0m16:25:49.582232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:25:49.584540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff9e6a9-0a4a-49b9-b8af-7fce8db8726f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109897550>]}
[0m16:25:49.632484 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:25:49.635447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:25:49.654577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff9e6a9-0a4a-49b9-b8af-7fce8db8726f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099eaac0>]}
[0m16:25:49.654839 [info ] [MainThread]: Found 3 seeds, 1 model, 456 macros
[0m16:25:49.655022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff9e6a9-0a4a-49b9-b8af-7fce8db8726f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f87c0>]}
[0m16:25:49.655674 [info ] [MainThread]: 
[0m16:25:49.655853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:49.656002 [info ] [MainThread]: 
[0m16:25:49.656238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:25:49.658677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab_main'
[0m16:25:49.733580 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:25:49.733801 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:25:49.733937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:49.738713 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:25:49.738885 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:25:49.739033 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:25:49.742847 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:25:49.743425 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:25:49.744298 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:25:49.744445 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:25:49.744715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff9e6a9-0a4a-49b9-b8af-7fce8db8726f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d3fa0>]}
[0m16:25:49.745885 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:25:49.746169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now model.data_lab_new.silver_transform)
[0m16:25:49.746340 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:25:49.749697 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:25:49.750521 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:25:49.750830 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:25:49.751006 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_customers
[0m16:25:49.751199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.data_lab_new.silver_transform, now seed.data_lab_new.raw_customers)
[0m16:25:49.751371 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_customers
[0m16:25:49.752221 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_customers
[0m16:25:49.752490 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_customers
[0m16:25:49.752654 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_orders
[0m16:25:49.752833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_customers, now seed.data_lab_new.raw_orders)
[0m16:25:49.752999 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_orders
[0m16:25:49.753825 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_orders
[0m16:25:49.754088 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_orders
[0m16:25:49.754245 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_payments
[0m16:25:49.754413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_orders, now seed.data_lab_new.raw_payments)
[0m16:25:49.754567 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_payments
[0m16:25:49.755358 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_payments
[0m16:25:49.755636 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_payments
[0m16:25:49.755982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:49.756140 [debug] [MainThread]: Connection 'seed.data_lab_new.raw_payments' was properly closed.
[0m16:25:49.756576 [debug] [MainThread]: Command end result
[0m16:25:49.768633 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:25:49.769739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:25:49.774709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:25:49.775910 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6201291, "process_in_blocks": "0", "process_kernel_time": 0.190314, "process_mem_max_rss": "139231232", "process_out_blocks": "0", "process_user_time": 0.957105}
[0m16:25:49.776099 [debug] [MainThread]: Command `dbt compile` succeeded at 16:25:49.776063 after 0.62 seconds
[0m16:25:49.776275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e04c0>]}
[0m16:25:49.776443 [debug] [MainThread]: Flushing usage events
[0m16:25:50.818664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:21.466475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ebd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109163910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109163730>]}


============================== 16:26:21.468798 | a3244f93-c780-449f-a342-23a5f2835daf ==============================
[0m16:26:21.468798 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:26:21.469090 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'static_parser': 'True', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None'}
[0m16:26:21.577566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109220c70>]}
[0m16:26:21.601313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eb070>]}
[0m16:26:21.602762 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:26:21.653084 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:26:21.741883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:21.742097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:21.745138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:26:21.761453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109760eb0>]}
[0m16:26:21.808509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:26:21.811616 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:26:21.892921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097679a0>]}
[0m16:26:21.893266 [info ] [MainThread]: Found 3 seeds, 1 model, 456 macros
[0m16:26:21.894623 [info ] [MainThread]: 
[0m16:26:21.894859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:21.895046 [info ] [MainThread]: 
[0m16:26:21.895347 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:26:21.898546 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:26:22.007000 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:26:22.007253 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:26:22.007395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:22.012381 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:26:22.012939 [debug] [ThreadPool]: On list_lab: Close
[0m16:26:22.013237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main)
[0m16:26:22.013430 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main"
"
[0m16:26:22.016380 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:22.016527 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:26:22.016656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:22.016953 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:22.017459 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:22.017611 [debug] [ThreadPool]: On create_lab_main: BEGIN
[0m16:26:22.017824 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:22.017969 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:22.018107 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
    
        create schema if not exists "lab"."main"
    
[0m16:26:22.018341 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:22.018684 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:26:22.018818 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:22.018939 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:26:22.019116 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:22.019250 [debug] [ThreadPool]: On create_lab_main: Close
[0m16:26:22.019785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main, now list_lab_main)
[0m16:26:22.022211 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:26:22.022368 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:26:22.022495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:22.022710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:22.022836 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:26:22.022966 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:26:22.026578 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:26:22.027063 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:26:22.027943 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:26:22.028092 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:26:22.028325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b98c70>]}
[0m16:26:22.028536 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.028674 [debug] [MainThread]: On master: BEGIN
[0m16:26:22.028800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:22.029009 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:22.029138 [debug] [MainThread]: On master: COMMIT
[0m16:26:22.029268 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.029398 [debug] [MainThread]: On master: COMMIT
[0m16:26:22.029590 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:22.029745 [debug] [MainThread]: On master: Close
[0m16:26:22.030921 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:26:22.031149 [info ] [Thread-1  ]: 1 of 4 START sql view model main.silver_transform .............................. [RUN]
[0m16:26:22.031464 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now model.data_lab_new.silver_transform)
[0m16:26:22.031640 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:26:22.035045 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:26:22.037363 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:26:22.050692 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:26:22.051433 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:22.051618 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:26:22.051768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:22.052069 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.052219 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:22.052379 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.order

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:26:22.053008 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.order

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:26:22.053197 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m16:26:22.053405 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: ROLLBACK
[0m16:26:22.119845 [debug] [Thread-1  ]: Failed to rollback 'model.data_lab_new.silver_transform'
[0m16:26:22.120152 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:26:22.122970 [debug] [Thread-1  ]: Runtime Error in model silver_transform (models/silver_transform.sql)
  Catalog Error: Table with name order does not exist!
  Did you mean "orders"?
  
  LINE 24:     from lab.bronze.order
                    ^
[0m16:26:22.125629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5cb80>]}
[0m16:26:22.126018 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model main.silver_transform ..................... [[31mERROR[0m in 0.09s]
[0m16:26:22.126339 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:26:22.126574 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_customers
[0m16:26:22.126828 [info ] [Thread-1  ]: 2 of 4 START seed file main.raw_customers ...................................... [RUN]
[0m16:26:22.127106 [debug] [Thread-4  ]: Marking all children of 'model.data_lab_new.silver_transform' to be skipped because of status 'error'.  Reason: Runtime Error in model silver_transform (models/silver_transform.sql)
  Catalog Error: Table with name order does not exist!
  Did you mean "orders"?
  
  LINE 24:     from lab.bronze.order
                    ^.
[0m16:26:22.127345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.data_lab_new.silver_transform, now seed.data_lab_new.raw_customers)
[0m16:26:22.127607 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_customers
[0m16:26:22.127812 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_customers
[0m16:26:22.141337 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:22.141603 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: BEGIN
[0m16:26:22.141781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:22.142117 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.142288 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:22.142456 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_customers"} */

    create table "lab"."main"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m16:26:22.142766 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.148002 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:22.148188 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: 
          COPY "lab"."main"."raw_customers" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:26:22.150204 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m16:26:22.152583 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_customers"
[0m16:26:22.161922 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: COMMIT
[0m16:26:22.162150 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:22.162320 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: COMMIT
[0m16:26:22.163065 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:26:22.164035 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: Close
[0m16:26:22.164349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4b490>]}
[0m16:26:22.164618 [info ] [Thread-1  ]: 2 of 4 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.04s]
[0m16:26:22.164919 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_customers
[0m16:26:22.165115 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_orders
[0m16:26:22.165387 [info ] [Thread-1  ]: 3 of 4 START seed file main.raw_orders ......................................... [RUN]
[0m16:26:22.165604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_customers, now seed.data_lab_new.raw_orders)
[0m16:26:22.165775 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_orders
[0m16:26:22.165939 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_orders
[0m16:26:22.170192 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:22.170392 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: BEGIN
[0m16:26:22.170555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:22.170943 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.171140 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:22.171311 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_orders"} */

    create table "lab"."main"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m16:26:22.171628 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.172250 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:22.172542 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: 
          COPY "lab"."main"."raw_orders" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:26:22.177852 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m16:26:22.178812 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_orders"
[0m16:26:22.188566 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: COMMIT
[0m16:26:22.188874 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:22.189236 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: COMMIT
[0m16:26:22.190848 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:26:22.192102 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: Close
[0m16:26:22.192983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a99430>]}
[0m16:26:22.193842 [info ] [Thread-1  ]: 3 of 4 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 99[0m in 0.03s]
[0m16:26:22.194825 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_orders
[0m16:26:22.195102 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_payments
[0m16:26:22.195404 [info ] [Thread-1  ]: 4 of 4 START seed file main.raw_payments ....................................... [RUN]
[0m16:26:22.195672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_orders, now seed.data_lab_new.raw_payments)
[0m16:26:22.195854 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_payments
[0m16:26:22.196027 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_payments
[0m16:26:22.202045 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:22.202657 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: BEGIN
[0m16:26:22.203105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:22.203830 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:26:22.204242 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:22.204445 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_payments"} */

    create table "lab"."main"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m16:26:22.204784 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.205396 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:22.205575 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: 
          COPY "lab"."main"."raw_payments" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:26:22.206737 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:26:22.207099 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_payments"
[0m16:26:22.210356 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: COMMIT
[0m16:26:22.210562 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:22.210714 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: COMMIT
[0m16:26:22.211099 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:22.211419 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: Close
[0m16:26:22.211674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3244f93-c780-449f-a342-23a5f2835daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd5640>]}
[0m16:26:22.211902 [info ] [Thread-1  ]: 4 of 4 OK loaded seed file main.raw_payments ................................... [[32mINSERT 113[0m in 0.02s]
[0m16:26:22.212177 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_payments
[0m16:26:22.212645 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.212798 [debug] [MainThread]: On master: BEGIN
[0m16:26:22.212922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:22.213141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:22.213285 [debug] [MainThread]: On master: COMMIT
[0m16:26:22.213419 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:22.213541 [debug] [MainThread]: On master: COMMIT
[0m16:26:22.213716 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:22.213858 [debug] [MainThread]: On master: Close
[0m16:26:22.214027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:22.214147 [debug] [MainThread]: Connection 'seed.data_lab_new.raw_payments' was properly closed.
[0m16:26:22.214297 [info ] [MainThread]: 
[0m16:26:22.214453 [info ] [MainThread]: Finished running 3 seeds, 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m16:26:22.214929 [debug] [MainThread]: Command end result
[0m16:26:22.229220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:26:22.231860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:26:22.240529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:26:22.240690 [info ] [MainThread]: 
[0m16:26:22.240882 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:22.241048 [info ] [MainThread]: 
[0m16:26:22.241218 [error] [MainThread]: [31mFailure in model silver_transform (models/silver_transform.sql)[0m
[0m16:26:22.241389 [error] [MainThread]:   Runtime Error in model silver_transform (models/silver_transform.sql)
  Catalog Error: Table with name order does not exist!
  Did you mean "orders"?
  
  LINE 24:     from lab.bronze.order
                    ^
[0m16:26:22.241531 [info ] [MainThread]: 
[0m16:26:22.241691 [info ] [MainThread]:   compiled code at target/compiled/data_lab_new/models/silver_transform.sql
[0m16:26:22.241834 [info ] [MainThread]: 
[0m16:26:22.241986 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m16:26:22.243258 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8099339, "process_in_blocks": "0", "process_kernel_time": 0.193927, "process_mem_max_rss": "143720448", "process_out_blocks": "0", "process_user_time": 0.994803}
[0m16:26:22.243436 [debug] [MainThread]: Command `dbt build` failed at 16:26:22.243402 after 0.81 seconds
[0m16:26:22.243608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ebd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eb070>]}
[0m16:26:22.243777 [debug] [MainThread]: Flushing usage events
[0m16:26:23.128989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:34.803027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55e610>]}


============================== 16:26:34.805506 | b91edfa0-ebef-4916-90e6-57a9d2bbe307 ==============================
[0m16:26:34.805506 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:26:34.805795 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt build', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80'}
[0m16:26:34.922367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec54f0>]}
[0m16:26:34.946634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b536d60>]}
[0m16:26:34.948356 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:26:34.998096 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:26:35.089779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:26:35.090060 [debug] [MainThread]: Partial parsing: updated file: data_lab_new://models/silver_transform.sql
[0m16:26:35.207524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:26:35.209903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f6820>]}
[0m16:26:35.255134 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:26:35.258277 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:26:35.287139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbcc820>]}
[0m16:26:35.287410 [info ] [MainThread]: Found 3 seeds, 1 model, 456 macros
[0m16:26:35.288513 [info ] [MainThread]: 
[0m16:26:35.288695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:35.288846 [info ] [MainThread]: 
[0m16:26:35.289095 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:26:35.291579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:26:35.366345 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:26:35.366573 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:26:35.366711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:35.373315 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:26:35.373896 [debug] [ThreadPool]: On list_lab: Close
[0m16:26:35.374213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main)
[0m16:26:35.374439 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main"
"
[0m16:26:35.377469 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:35.377622 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:26:35.377756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:35.378094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:35.378608 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:35.378760 [debug] [ThreadPool]: On create_lab_main: BEGIN
[0m16:26:35.378966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:35.379107 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:35.379239 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
    
        create schema if not exists "lab"."main"
    
[0m16:26:35.379458 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:35.379809 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:26:35.379947 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:26:35.380077 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:26:35.380272 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:35.380430 [debug] [ThreadPool]: On create_lab_main: Close
[0m16:26:35.380934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main, now list_lab_main)
[0m16:26:35.383320 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:26:35.383465 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:26:35.383589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:35.383803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:26:35.383928 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:26:35.384060 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:26:35.387745 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:26:35.388257 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:26:35.389167 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:26:35.389330 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:26:35.389810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b62e040>]}
[0m16:26:35.390013 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:35.390147 [debug] [MainThread]: On master: BEGIN
[0m16:26:35.390270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:35.390491 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:35.390620 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.390746 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:35.390872 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.391065 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:35.391205 [debug] [MainThread]: On master: Close
[0m16:26:35.392347 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:26:35.392571 [info ] [Thread-1  ]: 1 of 4 START sql view model main.silver_transform .............................. [RUN]
[0m16:26:35.392805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now model.data_lab_new.silver_transform)
[0m16:26:35.392976 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:26:35.396363 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:26:35.397205 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:26:35.410669 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:26:35.413154 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:35.413342 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:26:35.413491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:35.413785 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.413949 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:35.414116 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:26:35.414599 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.417488 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:35.417662 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform__dbt_tmp" rename to "silver_transform"
[0m16:26:35.417984 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.422031 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:26:35.422195 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:35.422341 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:26:35.422902 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.425304 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:26:35.425471 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main"."silver_transform__dbt_backup" cascade
    
[0m16:26:35.425726 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.426767 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:26:35.427571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd62fd0>]}
[0m16:26:35.427868 [info ] [Thread-1  ]: 1 of 4 OK created sql view model main.silver_transform ......................... [[32mOK[0m in 0.03s]
[0m16:26:35.428121 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:26:35.428314 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_customers
[0m16:26:35.428561 [info ] [Thread-1  ]: 2 of 4 START seed file main.raw_customers ...................................... [RUN]
[0m16:26:35.428774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.data_lab_new.silver_transform, now seed.data_lab_new.raw_customers)
[0m16:26:35.428970 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_customers
[0m16:26:35.429144 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_customers
[0m16:26:35.441833 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:35.442050 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: BEGIN
[0m16:26:35.442198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:35.442492 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.442636 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:35.442778 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_customers"} */
truncate table "lab"."main"."raw_customers"
[0m16:26:35.443115 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.447714 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:35.447881 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: 
          COPY "lab"."main"."raw_customers" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:26:35.449387 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:26:35.451609 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_customers"
[0m16:26:35.454922 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: COMMIT
[0m16:26:35.455091 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_customers"
[0m16:26:35.455240 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: COMMIT
[0m16:26:35.455674 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.456030 [debug] [Thread-1  ]: On seed.data_lab_new.raw_customers: Close
[0m16:26:35.456316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd62fd0>]}
[0m16:26:35.456564 [info ] [Thread-1  ]: 2 of 4 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.03s]
[0m16:26:35.456823 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_customers
[0m16:26:35.456987 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_orders
[0m16:26:35.457215 [info ] [Thread-1  ]: 3 of 4 START seed file main.raw_orders ......................................... [RUN]
[0m16:26:35.457414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_customers, now seed.data_lab_new.raw_orders)
[0m16:26:35.457583 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_orders
[0m16:26:35.457737 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_orders
[0m16:26:35.461506 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:35.461659 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: BEGIN
[0m16:26:35.461799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:35.462021 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.462179 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:35.462333 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_orders"} */
truncate table "lab"."main"."raw_orders"
[0m16:26:35.462617 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.463170 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:35.463359 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: 
          COPY "lab"."main"."raw_orders" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:26:35.466273 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m16:26:35.466789 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_orders"
[0m16:26:35.469940 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: COMMIT
[0m16:26:35.470121 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_orders"
[0m16:26:35.470268 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: COMMIT
[0m16:26:35.470707 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.471055 [debug] [Thread-1  ]: On seed.data_lab_new.raw_orders: Close
[0m16:26:35.471320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c58e0>]}
[0m16:26:35.471555 [info ] [Thread-1  ]: 3 of 4 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 99[0m in 0.01s]
[0m16:26:35.471816 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_orders
[0m16:26:35.471985 [debug] [Thread-1  ]: Began running node seed.data_lab_new.raw_payments
[0m16:26:35.472219 [info ] [Thread-1  ]: 4 of 4 START seed file main.raw_payments ....................................... [RUN]
[0m16:26:35.472425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.data_lab_new.raw_orders, now seed.data_lab_new.raw_payments)
[0m16:26:35.472579 [debug] [Thread-1  ]: Began compiling node seed.data_lab_new.raw_payments
[0m16:26:35.472726 [debug] [Thread-1  ]: Began executing node seed.data_lab_new.raw_payments
[0m16:26:35.476587 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:35.476754 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: BEGIN
[0m16:26:35.476899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:35.477159 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.477319 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:35.477471 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "seed.data_lab_new.raw_payments"} */
truncate table "lab"."main"."raw_payments"
[0m16:26:35.477748 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.478260 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:35.478412 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: 
          COPY "lab"."main"."raw_payments" FROM '/Users/davidhe/data-lab-new/src/seeds/raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:26:35.479477 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:26:35.479803 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.data_lab_new.raw_payments"
[0m16:26:35.482523 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: COMMIT
[0m16:26:35.482703 [debug] [Thread-1  ]: Using duckdb connection "seed.data_lab_new.raw_payments"
[0m16:26:35.482844 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: COMMIT
[0m16:26:35.483278 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:26:35.483638 [debug] [Thread-1  ]: On seed.data_lab_new.raw_payments: Close
[0m16:26:35.483905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91edfa0-ebef-4916-90e6-57a9d2bbe307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ce730>]}
[0m16:26:35.484146 [info ] [Thread-1  ]: 4 of 4 OK loaded seed file main.raw_payments ................................... [[32mINSERT 113[0m in 0.01s]
[0m16:26:35.484406 [debug] [Thread-1  ]: Finished running node seed.data_lab_new.raw_payments
[0m16:26:35.484889 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:35.485044 [debug] [MainThread]: On master: BEGIN
[0m16:26:35.485171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:35.485379 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:35.485521 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.485651 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:35.485776 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.485984 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:26:35.486149 [debug] [MainThread]: On master: Close
[0m16:26:35.486323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:35.486445 [debug] [MainThread]: Connection 'seed.data_lab_new.raw_payments' was properly closed.
[0m16:26:35.486596 [info ] [MainThread]: 
[0m16:26:35.486754 [info ] [MainThread]: Finished running 3 seeds, 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m16:26:35.487211 [debug] [MainThread]: Command end result
[0m16:26:35.503964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:26:35.506550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:26:35.516312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:26:35.516460 [info ] [MainThread]: 
[0m16:26:35.516664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:35.516820 [info ] [MainThread]: 
[0m16:26:35.516977 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:26:35.518483 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.77222604, "process_in_blocks": "0", "process_kernel_time": 0.191494, "process_mem_max_rss": "149798912", "process_out_blocks": "0", "process_user_time": 1.04576}
[0m16:26:35.518690 [debug] [MainThread]: Command `dbt build` succeeded at 16:26:35.518656 after 0.77 seconds
[0m16:26:35.518864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbcc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d9730>]}
[0m16:26:35.519036 [debug] [MainThread]: Flushing usage events
[0m16:26:36.947257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:05.199230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be23cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9a610>]}


============================== 16:27:05.201818 | 5fdd80cb-43a4-4f5f-850b-a2b0bbe25049 ==============================
[0m16:27:05.201818 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:27:05.202114 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'log_format': 'default', 'invocation_command': 'dbt build', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:27:05.316224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fdd80cb-43a4-4f5f-850b-a2b0bbe25049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8004f0>]}
[0m16:27:05.340310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fdd80cb-43a4-4f5f-850b-a2b0bbe25049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce70d60>]}
[0m16:27:05.341743 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:27:05.391899 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:27:05.485528 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m16:27:05.485763 [debug] [MainThread]: Partial parsing: deleted file: data_lab_new://seeds/raw_payments.csv
[0m16:27:05.485905 [debug] [MainThread]: Partial parsing: deleted file: data_lab_new://seeds/raw_orders.csv
[0m16:27:05.486033 [debug] [MainThread]: Partial parsing: deleted file: data_lab_new://seeds/raw_customers.csv
[0m16:27:05.510672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:27:05.513103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fdd80cb-43a4-4f5f-850b-a2b0bbe25049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a7130>]}
[0m16:27:05.556701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:27:05.559812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:27:05.610057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fdd80cb-43a4-4f5f-850b-a2b0bbe25049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c0610>]}
[0m16:27:05.610369 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:27:05.611042 [info ] [MainThread]: 
[0m16:27:05.611230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:05.611381 [info ] [MainThread]: 
[0m16:27:05.611622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:27:05.612045 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:27:05.687834 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:27:05.688065 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:27:05.688204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:05.693375 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:27:05.693921 [debug] [ThreadPool]: On list_lab: Close
[0m16:27:05.694290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main)
[0m16:27:05.694541 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main"
"
[0m16:27:05.697753 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:27:05.697933 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:27:05.698069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:05.698439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:05.698986 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:27:05.699131 [debug] [ThreadPool]: On create_lab_main: BEGIN
[0m16:27:05.699346 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:05.699476 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:27:05.699607 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
    
        create schema if not exists "lab"."main"
    
[0m16:27:05.699815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:05.700143 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:27:05.700279 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:27:05.700406 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:27:05.700586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:05.700721 [debug] [ThreadPool]: On create_lab_main: Close
[0m16:27:05.701137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main, now list_lab_main)
[0m16:27:05.703752 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:27:05.703910 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:27:05.704045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:05.704265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:27:05.704392 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:27:05.704523 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:27:05.708336 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:27:05.708871 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:27:05.709826 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:27:05.709974 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:27:05.710445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fdd80cb-43a4-4f5f-850b-a2b0bbe25049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d618940>]}
[0m16:27:05.710645 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:05.710776 [debug] [MainThread]: On master: BEGIN
[0m16:27:05.710898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:05.711105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:27:05.711231 [debug] [MainThread]: On master: COMMIT
[0m16:27:05.711358 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:05.711480 [debug] [MainThread]: On master: COMMIT
[0m16:27:05.711653 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:27:05.711784 [debug] [MainThread]: On master: Close
[0m16:27:05.712826 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:27:05.713052 [info ] [Thread-1  ]: 1 of 1 START sql view model main.silver_transform .............................. [RUN]
[0m16:27:05.713277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now model.data_lab_new.silver_transform)
[0m16:27:05.713436 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:27:05.716537 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:27:05.718666 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:27:05.734110 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:27:05.736719 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:27:05.736896 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:27:05.737047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:27:05.737354 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:27:05.737503 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:27:05.737667 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:27:05.738169 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:27:05.740996 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:27:05.741168 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform" rename to "silver_transform__dbt_backup"
[0m16:27:05.741443 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:27:05.742787 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:27:05.742950 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform__dbt_tmp" rename to "silver_transform"
[0m16:27:05.743190 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:27:05.748552 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:27:05.748717 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:27:05.748862 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:27:05.749422 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:27:05.751800 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:27:05.751967 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main"."silver_transform__dbt_backup" cascade
    
[0m16:27:05.752263 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:27:05.753283 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:27:05.754150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fdd80cb-43a4-4f5f-850b-a2b0bbe25049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d973700>]}
[0m16:27:05.754450 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main.silver_transform ......................... [[32mOK[0m in 0.04s]
[0m16:27:05.754709 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:27:05.755179 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:05.755350 [debug] [MainThread]: On master: BEGIN
[0m16:27:05.755482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:05.755700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:27:05.755848 [debug] [MainThread]: On master: COMMIT
[0m16:27:05.755982 [debug] [MainThread]: Using duckdb connection "master"
[0m16:27:05.756145 [debug] [MainThread]: On master: COMMIT
[0m16:27:05.756368 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:27:05.756526 [debug] [MainThread]: On master: Close
[0m16:27:05.756689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:05.756812 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m16:27:05.756944 [info ] [MainThread]: 
[0m16:27:05.757097 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m16:27:05.757386 [debug] [MainThread]: Command end result
[0m16:27:05.769413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:27:05.770840 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:27:05.776257 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:27:05.776410 [info ] [MainThread]: 
[0m16:27:05.776603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:05.776755 [info ] [MainThread]: 
[0m16:27:05.776914 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:27:05.778133 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6131048, "process_in_blocks": "0", "process_kernel_time": 0.188353, "process_mem_max_rss": "138887168", "process_out_blocks": "0", "process_user_time": 0.926243}
[0m16:27:05.778342 [debug] [MainThread]: Command `dbt build` succeeded at 16:27:05.778294 after 0.61 seconds
[0m16:27:05.778525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be23cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf802b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce69be0>]}
[0m16:27:05.778711 [debug] [MainThread]: Flushing usage events
[0m16:27:06.844855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:17.212139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099dbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa538e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa53700>]}


============================== 16:32:17.214444 | f75b8574-d85c-473e-83fa-74684248fce0 ==============================
[0m16:32:17.214444 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:32:17.214700 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'version_check': 'True', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m16:32:17.329135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f75b8574-d85c-473e-83fa-74684248fce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081972b0>]}
[0m16:32:17.353230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f75b8574-d85c-473e-83fa-74684248fce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab73430>]}
[0m16:32:17.354807 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:32:17.404652 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:32:17.485789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:17.485993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:17.489139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:32:17.499896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f75b8574-d85c-473e-83fa-74684248fce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01c130>]}
[0m16:32:17.541690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:32:17.544877 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:32:17.570844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f75b8574-d85c-473e-83fa-74684248fce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afec3a0>]}
[0m16:32:17.571103 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:32:17.571279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f75b8574-d85c-473e-83fa-74684248fce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4ae80>]}
[0m16:32:17.571846 [info ] [MainThread]: 
[0m16:32:17.572022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:17.572167 [info ] [MainThread]: 
[0m16:32:17.572403 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:32:17.572838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:32:17.672603 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:32:17.672840 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:32:17.672990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:17.677112 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:32:17.677302 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:32:17.677660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:17.677832 [debug] [MainThread]: Connection 'list_lab' was properly closed.
[0m16:32:17.677974 [info ] [MainThread]: 
[0m16:32:17.678139 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m16:32:17.678382 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/src/../database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 14706) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m16:32:17.679609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5255465, "process_in_blocks": "0", "process_kernel_time": 0.186045, "process_mem_max_rss": "129826816", "process_out_blocks": "0", "process_user_time": 0.827721}
[0m16:32:17.679820 [debug] [MainThread]: Command `dbt run` failed at 16:32:17.679781 after 0.53 seconds
[0m16:32:17.679996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099dbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab5ec10>]}
[0m16:32:17.680174 [debug] [MainThread]: Flushing usage events
[0m16:32:18.786921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:37.713790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5e3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65b6a0>]}


============================== 16:39:37.716678 | c5527e3c-b0ff-4c8e-8880-0d8922299a68 ==============================
[0m16:39:37.716678 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:39:37.716964 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run'}
[0m16:39:37.877932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc0700>]}
[0m16:39:37.903275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b82f7f0>]}
[0m16:39:37.904812 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:39:37.961656 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:39:38.030409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:38.030647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:38.034061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:39:38.045535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc24130>]}
[0m16:39:38.078755 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:39:38.083531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:39:38.100573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf9f10>]}
[0m16:39:38.100871 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:39:38.101220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc39e50>]}
[0m16:39:38.101908 [info ] [MainThread]: 
[0m16:39:38.102125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:38.102287 [info ] [MainThread]: 
[0m16:39:38.102552 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:39:38.103021 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:39:38.204319 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:39:38.204575 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:39:38.204750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:38.218926 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:39:38.219655 [debug] [ThreadPool]: On list_lab: Close
[0m16:39:38.220010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main)
[0m16:39:38.220237 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main"
"
[0m16:39:38.223924 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:39:38.224120 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:39:38.224269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:38.224944 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:39:38.225587 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:39:38.225759 [debug] [ThreadPool]: On create_lab_main: BEGIN
[0m16:39:38.226192 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:38.226839 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:39:38.227280 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
    
        create schema if not exists "lab"."main"
    
[0m16:39:38.227890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:38.228395 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:39:38.228572 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:39:38.228727 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:39:38.228966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:38.229120 [debug] [ThreadPool]: On create_lab_main: Close
[0m16:39:38.229624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main, now list_lab_main)
[0m16:39:38.232499 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:39:38.232669 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:39:38.232797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:38.233050 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:38.233193 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:39:38.233338 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:39:38.238865 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:39:38.239765 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:39:38.240971 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:39:38.241121 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:39:38.241664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc43520>]}
[0m16:39:38.241893 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:38.242041 [debug] [MainThread]: On master: BEGIN
[0m16:39:38.242167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:38.242381 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:38.242525 [debug] [MainThread]: On master: COMMIT
[0m16:39:38.242671 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:38.242815 [debug] [MainThread]: On master: COMMIT
[0m16:39:38.243027 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:38.243204 [debug] [MainThread]: On master: Close
[0m16:39:38.244764 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:39:38.245023 [info ] [Thread-1  ]: 1 of 1 START sql view model main.silver_transform .............................. [RUN]
[0m16:39:38.245245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now model.data_lab_new.silver_transform)
[0m16:39:38.245421 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:39:38.248874 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:39:38.250585 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:39:38.267970 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:39:38.269934 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:39:38.270174 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:39:38.270346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:39:38.270673 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:39:38.270844 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:39:38.271030 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:39:38.271819 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:39:38.274783 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:39:38.274989 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform" rename to "silver_transform__dbt_backup"
[0m16:39:38.275536 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:39:38.277737 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:39:38.277925 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform__dbt_tmp" rename to "silver_transform"
[0m16:39:38.278252 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:39:38.283574 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:39:38.283770 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:39:38.283940 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:39:38.284575 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:39:38.287431 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:39:38.287632 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main"."silver_transform__dbt_backup" cascade
    
[0m16:39:38.287996 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:39:38.289106 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:39:38.290258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5527e3c-b0ff-4c8e-8880-0d8922299a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc38fd0>]}
[0m16:39:38.290621 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main.silver_transform ......................... [[32mOK[0m in 0.04s]
[0m16:39:38.290915 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:39:38.291430 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:38.291598 [debug] [MainThread]: On master: BEGIN
[0m16:39:38.291736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:38.291996 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:38.292144 [debug] [MainThread]: On master: COMMIT
[0m16:39:38.292280 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:38.292407 [debug] [MainThread]: On master: COMMIT
[0m16:39:38.292594 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:38.292827 [debug] [MainThread]: On master: Close
[0m16:39:38.293037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:38.293181 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m16:39:38.293335 [info ] [MainThread]: 
[0m16:39:38.293496 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:39:38.293797 [debug] [MainThread]: Command end result
[0m16:39:38.306579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:39:38.307931 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:39:38.312798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:39:38.313006 [info ] [MainThread]: 
[0m16:39:38.313218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:38.313378 [info ] [MainThread]: 
[0m16:39:38.313547 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:39:38.314939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6368992, "process_in_blocks": "0", "process_kernel_time": 0.211204, "process_mem_max_rss": "137510912", "process_out_blocks": "0", "process_user_time": 0.931164}
[0m16:39:38.315147 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:38.315108 after 0.64 seconds
[0m16:39:38.315343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5e3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf9400>]}
[0m16:39:38.315519 [debug] [MainThread]: Flushing usage events
[0m16:39:39.244230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:16.497663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce37880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce376a0>]}


============================== 16:42:16.500361 | bca7bc64-58b2-4889-a32b-5d39ac59434f ==============================
[0m16:42:16.500361 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:42:16.500638 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'log_format': 'default', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False'}
[0m16:42:16.617575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca7bc64-58b2-4889-a32b-5d39ac59434f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a79d700>]}
[0m16:42:16.641756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca7bc64-58b2-4889-a32b-5d39ac59434f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d00e7f0>]}
[0m16:42:16.644320 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:42:16.697971 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:42:16.782747 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:42:16.783007 [debug] [MainThread]: Partial parsing: added file: data_lab_new://models/silver/silver_transform.sql
[0m16:42:16.783160 [debug] [MainThread]: Partial parsing: deleted file: data_lab_new://models/silver_transform.sql
[0m16:42:16.897404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:42:16.899734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca7bc64-58b2-4889-a32b-5d39ac59434f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0195b0>]}
[0m16:42:16.940597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:42:16.948320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:42:16.974249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca7bc64-58b2-4889-a32b-5d39ac59434f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde7400>]}
[0m16:42:16.974501 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:42:16.974675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca7bc64-58b2-4889-a32b-5d39ac59434f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01b760>]}
[0m16:42:16.975236 [info ] [MainThread]: 
[0m16:42:16.975406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:16.975553 [info ] [MainThread]: 
[0m16:42:16.975791 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:42:16.976213 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:42:17.051105 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:42:17.051325 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:42:17.051460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:17.058988 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:42:17.059175 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:42:17.059535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:17.059682 [debug] [MainThread]: Connection 'list_lab' was properly closed.
[0m16:42:17.059817 [info ] [MainThread]: 
[0m16:42:17.059983 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m16:42:17.060221 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/src/../database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 15043) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m16:42:17.061453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.62841326, "process_in_blocks": "0", "process_kernel_time": 0.224522, "process_mem_max_rss": "133578752", "process_out_blocks": "0", "process_user_time": 0.952716}
[0m16:42:17.061639 [debug] [MainThread]: Command `dbt run` failed at 16:42:17.061604 after 0.63 seconds
[0m16:42:17.061804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d43e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ee910>]}
[0m16:42:17.061972 [debug] [MainThread]: Flushing usage events
[0m16:42:18.056543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:35.513278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be2fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea7640>]}


============================== 16:42:35.516029 | 01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59 ==============================
[0m16:42:35.516029 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:42:35.516299 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m16:42:35.632267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf387f0>]}
[0m16:42:35.656125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7567f0>]}
[0m16:42:35.658543 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:42:35.710770 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:42:35.792639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:35.792838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:35.796039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop
- data_tests
[0m16:42:35.806663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d484130>]}
[0m16:42:35.850041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:42:35.852940 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:42:35.878590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d49bc10>]}
[0m16:42:35.878864 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:42:35.879047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d49bbb0>]}
[0m16:42:35.879656 [info ] [MainThread]: 
[0m16:42:35.879844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:35.879995 [info ] [MainThread]: 
[0m16:42:35.880246 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:42:35.880681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:42:35.978284 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:42:35.978520 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:42:35.978665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:35.983873 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:42:35.984418 [debug] [ThreadPool]: On list_lab: Close
[0m16:42:35.984729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main)
[0m16:42:35.984953 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main"
"
[0m16:42:35.988156 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:42:35.988323 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:42:35.988458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:35.988775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:42:35.989254 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:42:35.989391 [debug] [ThreadPool]: On create_lab_main: BEGIN
[0m16:42:35.989578 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:42:35.989706 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:42:35.989832 [debug] [ThreadPool]: On create_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main"} */

    
    
        create schema if not exists "lab"."main"
    
[0m16:42:35.990061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:42:35.990431 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:42:35.990576 [debug] [ThreadPool]: Using duckdb connection "create_lab_main"
[0m16:42:35.990706 [debug] [ThreadPool]: On create_lab_main: COMMIT
[0m16:42:35.990903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:42:35.991034 [debug] [ThreadPool]: On create_lab_main: Close
[0m16:42:35.991433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main, now list_lab_main)
[0m16:42:35.993767 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:42:35.993919 [debug] [ThreadPool]: On list_lab_main: BEGIN
[0m16:42:35.994048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:35.994265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:42:35.994393 [debug] [ThreadPool]: Using duckdb connection "list_lab_main"
[0m16:42:35.994527 [debug] [ThreadPool]: On list_lab_main: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'lab'
  
[0m16:42:35.998210 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:42:35.998707 [debug] [ThreadPool]: On list_lab_main: ROLLBACK
[0m16:42:36.000427 [debug] [ThreadPool]: Failed to rollback 'list_lab_main'
[0m16:42:36.000574 [debug] [ThreadPool]: On list_lab_main: Close
[0m16:42:36.001040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfbff40>]}
[0m16:42:36.001245 [debug] [MainThread]: Using duckdb connection "master"
[0m16:42:36.001375 [debug] [MainThread]: On master: BEGIN
[0m16:42:36.001498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:36.001705 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:42:36.001832 [debug] [MainThread]: On master: COMMIT
[0m16:42:36.001956 [debug] [MainThread]: Using duckdb connection "master"
[0m16:42:36.002078 [debug] [MainThread]: On master: COMMIT
[0m16:42:36.002287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:42:36.002464 [debug] [MainThread]: On master: Close
[0m16:42:36.003982 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:42:36.004211 [info ] [Thread-1  ]: 1 of 1 START sql view model main.silver_transform .............................. [RUN]
[0m16:42:36.004435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main, now model.data_lab_new.silver_transform)
[0m16:42:36.004600 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:42:36.007661 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:42:36.008157 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:42:36.023589 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:42:36.024238 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:42:36.024420 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:42:36.024569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:36.024908 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:42:36.025090 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:42:36.025330 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:42:36.025899 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:42:36.028662 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:42:36.028835 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform" rename to "silver_transform__dbt_backup"
[0m16:42:36.029117 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:42:36.030930 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:42:36.031089 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main"."silver_transform__dbt_tmp" rename to "silver_transform"
[0m16:42:36.031336 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:42:36.036351 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:42:36.036529 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:42:36.036681 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:42:36.037226 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:42:36.039540 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:42:36.039703 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main"."silver_transform__dbt_backup" cascade
    
[0m16:42:36.039998 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:42:36.040988 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:42:36.042015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d3ca26-ddb9-4ec9-9f1f-941bdc41cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfbff40>]}
[0m16:42:36.042300 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main.silver_transform ......................... [[32mOK[0m in 0.04s]
[0m16:42:36.042562 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:42:36.043027 [debug] [MainThread]: Using duckdb connection "master"
[0m16:42:36.043181 [debug] [MainThread]: On master: BEGIN
[0m16:42:36.043304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:36.043512 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:42:36.043655 [debug] [MainThread]: On master: COMMIT
[0m16:42:36.043791 [debug] [MainThread]: Using duckdb connection "master"
[0m16:42:36.043915 [debug] [MainThread]: On master: COMMIT
[0m16:42:36.044085 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:42:36.044227 [debug] [MainThread]: On master: Close
[0m16:42:36.044391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:36.044513 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m16:42:36.044650 [info ] [MainThread]: 
[0m16:42:36.044799 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:42:36.045088 [debug] [MainThread]: Command end result
[0m16:42:36.057442 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:42:36.059132 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:42:36.068185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:42:36.068342 [info ] [MainThread]: 
[0m16:42:36.068553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:36.068710 [info ] [MainThread]: 
[0m16:42:36.068885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:42:36.070140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5918032, "process_in_blocks": "0", "process_kernel_time": 0.200368, "process_mem_max_rss": "137609216", "process_out_blocks": "0", "process_user_time": 0.911324}
[0m16:42:36.070333 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:36.070292 after 0.59 seconds
[0m16:42:36.070505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be2fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a611c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1218b0>]}
[0m16:42:36.070676 [debug] [MainThread]: Flushing usage events
[0m16:42:36.970276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:01.612887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd3790>]}


============================== 16:49:01.615638 | 614cefb1-0fe2-4ab5-ba41-d777db619e23 ==============================
[0m16:49:01.615638 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:49:01.615911 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m16:49:01.690705 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('data_lab_new' was unexpected)

Error encountered in /Users/davidhe/data-lab-new/src/dbt_project.yml
[0m16:49:01.692587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1556588, "process_in_blocks": "0", "process_kernel_time": 0.134286, "process_mem_max_rss": "116047872", "process_out_blocks": "0", "process_user_time": 0.641238}
[0m16:49:01.692802 [debug] [MainThread]: Command `dbt run` failed at 16:49:01.692759 after 0.16 seconds
[0m16:49:01.692973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1a9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1a95e0>]}
[0m16:49:01.693144 [debug] [MainThread]: Flushing usage events
[0m16:49:02.632665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:52.214165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896b6a0>]}


============================== 16:49:52.216943 | a14c5dd2-3af6-4b76-9122-417b095b7224 ==============================
[0m16:49:52.216943 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:49:52.217218 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'empty': 'False', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt run', 'target_path': 'None'}
[0m16:49:52.336186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d1700>]}
[0m16:49:52.360331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b407f0>]}
[0m16:49:52.362991 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:49:52.414636 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:49:52.446311 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:49:52.446555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e6790>]}
[0m16:49:52.930353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m16:49:52.932697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900efd0>]}
[0m16:49:52.974040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:49:52.976256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:49:52.999918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090984c0>]}
[0m16:49:53.000174 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:49:53.000353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090592b0>]}
[0m16:49:53.000906 [info ] [MainThread]: 
[0m16:49:53.001084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:53.001231 [info ] [MainThread]: 
[0m16:49:53.001505 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:49:53.001901 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:49:53.076753 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:49:53.076985 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:49:53.077141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:53.082365 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:49:53.082906 [debug] [ThreadPool]: On list_lab: Close
[0m16:49:53.083217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m16:49:53.083421 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m16:49:53.086468 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:49:53.086625 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:49:53.086754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:53.087078 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:53.087553 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:49:53.087688 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m16:49:53.087877 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:53.088007 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:49:53.088135 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m16:49:53.088333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:53.088648 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m16:49:53.088781 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:49:53.088904 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m16:49:53.089515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:53.089655 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m16:49:53.090066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m16:49:53.092699 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m16:49:53.092866 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m16:49:53.093001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:53.093218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:53.093366 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m16:49:53.093515 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m16:49:53.097139 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:49:53.097608 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m16:49:53.098789 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m16:49:53.098937 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m16:49:53.099169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109137220>]}
[0m16:49:53.099371 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:53.099504 [debug] [MainThread]: On master: BEGIN
[0m16:49:53.099626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:53.099835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:53.099977 [debug] [MainThread]: On master: COMMIT
[0m16:49:53.100121 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:53.100250 [debug] [MainThread]: On master: COMMIT
[0m16:49:53.100439 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:53.100598 [debug] [MainThread]: On master: Close
[0m16:49:53.101963 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:49:53.102189 [info ] [Thread-1  ]: 1 of 1 START sql view model main_silver.silver_transform ....................... [RUN]
[0m16:49:53.102401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m16:49:53.102576 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:49:53.105748 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:49:53.107647 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:49:53.123287 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:49:53.125848 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:49:53.126027 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:49:53.126177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:53.126472 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:49:53.126637 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:49:53.126801 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
  create view "lab"."main_silver"."silver_transform__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );

[0m16:49:53.127267 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:49:53.130058 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:49:53.130223 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main_silver"."silver_transform__dbt_tmp" rename to "silver_transform"
[0m16:49:53.130475 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:49:53.134528 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:49:53.134728 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:49:53.134885 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:49:53.135253 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:49:53.137565 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:49:53.137762 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main_silver"."silver_transform__dbt_backup" cascade
    
[0m16:49:53.137991 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:49:53.139091 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:49:53.140250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14c5dd2-3af6-4b76-9122-417b095b7224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ee340>]}
[0m16:49:53.140545 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main_silver.silver_transform .................. [[32mOK[0m in 0.04s]
[0m16:49:53.140808 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:49:53.141304 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:53.141456 [debug] [MainThread]: On master: BEGIN
[0m16:49:53.141583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:53.141819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:53.141962 [debug] [MainThread]: On master: COMMIT
[0m16:49:53.142097 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:53.142237 [debug] [MainThread]: On master: COMMIT
[0m16:49:53.142446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:53.142623 [debug] [MainThread]: On master: Close
[0m16:49:53.142795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:53.142922 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m16:49:53.143059 [info ] [MainThread]: 
[0m16:49:53.143217 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m16:49:53.143515 [debug] [MainThread]: Command end result
[0m16:49:53.155961 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m16:49:53.157504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m16:49:53.162949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m16:49:53.163135 [info ] [MainThread]: 
[0m16:49:53.163347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:53.163502 [info ] [MainThread]: 
[0m16:49:53.163667 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:53.164955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99571264, "process_in_blocks": "0", "process_kernel_time": 0.20184, "process_mem_max_rss": "141049856", "process_out_blocks": "0", "process_user_time": 1.310499}
[0m16:49:53.165174 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:53.165136 after 1.00 seconds
[0m16:49:53.165365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b407f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090927f0>]}
[0m16:49:53.165536 [debug] [MainThread]: Flushing usage events
[0m16:49:54.189843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:40.533979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108313a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093898b0>]}


============================== 14:01:40.543954 | 3166c7c2-c48a-4df3-819a-13f7ca53873a ==============================
[0m14:01:40.543954 [info ] [MainThread]: Running with dbt=1.10.18
[0m14:01:40.544587 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new/src', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'log_path': '/Users/davidhe/data-lab-new/src/logs', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'write_json': 'True'}
[0m14:01:40.964249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3166c7c2-c48a-4df3-819a-13f7ca53873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c11070>]}
[0m14:01:40.992472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3166c7c2-c48a-4df3-819a-13f7ca53873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095edd90>]}
[0m14:01:41.000620 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:01:41.125150 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m14:01:41.433710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:41.434095 [debug] [MainThread]: Partial parsing: updated file: data_lab_new://models/silver/silver_transform.sql
[0m14:01:41.572406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m14:01:41.575107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3166c7c2-c48a-4df3-819a-13f7ca53873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a3370>]}
[0m14:01:41.611958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m14:01:41.618543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m14:01:41.685781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3166c7c2-c48a-4df3-819a-13f7ca53873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a3670>]}
[0m14:01:41.686135 [info ] [MainThread]: Found 1 model, 456 macros
[0m14:01:41.686319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3166c7c2-c48a-4df3-819a-13f7ca53873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a34c0>]}
[0m14:01:41.687026 [info ] [MainThread]: 
[0m14:01:41.687304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:41.687493 [info ] [MainThread]: 
[0m14:01:41.687777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:01:41.688196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab_main_silver'
[0m14:01:42.339642 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m14:01:42.340191 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m14:01:42.340608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:42.354258 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:01:42.354761 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m14:01:42.355098 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m14:01:42.361464 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:01:42.362293 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m14:01:42.367345 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m14:01:42.367566 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m14:01:42.368003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3166c7c2-c48a-4df3-819a-13f7ca53873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941f6d0>]}
[0m14:01:42.372388 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m14:01:42.372835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m14:01:42.373042 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m14:01:42.377124 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m14:01:42.379434 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m14:01:42.379820 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m14:01:42.380219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:42.380362 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m14:01:42.380661 [debug] [MainThread]: Command end result
[0m14:01:42.393457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/src/target/manifest.json
[0m14:01:42.395202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/src/target/semantic_manifest.json
[0m14:01:42.401568 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/src/target/run_results.json
[0m14:01:42.407594 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0397308, "process_in_blocks": "0", "process_kernel_time": 0.443813, "process_mem_max_rss": "139034624", "process_out_blocks": "0", "process_user_time": 1.406519}
[0m14:01:42.407874 [debug] [MainThread]: Command `dbt compile` succeeded at 14:01:42.407832 after 2.04 seconds
[0m14:01:42.408070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108313a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095edd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f41c0>]}
[0m14:01:42.408251 [debug] [MainThread]: Flushing usage events
[0m14:01:43.294155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:02.762115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980c2e0>]}


============================== 17:19:02.764990 | 5b43dee2-886c-4728-90af-71cccd6bdee6 ==============================
[0m17:19:02.764990 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:19:02.765309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/Users/davidhe/data-lab-new/logs', 'profiles_dir': '/Users/davidhe/data-lab-new', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'invocation_command': 'dbt run --debug', 'write_json': 'True', 'debug': 'True', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m17:19:02.895532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b43dee2-886c-4728-90af-71cccd6bdee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109649340>]}
[0m17:19:02.921454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b43dee2-886c-4728-90af-71cccd6bdee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d1910>]}
[0m17:19:02.923213 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:19:03.019637 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:19:03.088841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:03.089104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:03.092232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:19:03.102741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b43dee2-886c-4728-90af-71cccd6bdee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de2130>]}
[0m17:19:03.143074 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:19:03.159339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:19:03.284674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b43dee2-886c-4728-90af-71cccd6bdee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0bbb0>]}
[0m17:19:03.285127 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:19:03.285360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b43dee2-886c-4728-90af-71cccd6bdee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9beb0>]}
[0m17:19:03.286231 [info ] [MainThread]: 
[0m17:19:03.286476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:03.286757 [info ] [MainThread]: 
[0m17:19:03.287169 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:19:03.287990 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:19:03.392975 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:19:03.393250 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:19:03.393415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:03.397660 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:19:03.397855 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:19:03.398302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:03.398469 [debug] [MainThread]: Connection 'list_lab' was properly closed.
[0m17:19:03.398623 [info ] [MainThread]: 
[0m17:19:03.398786 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m17:19:03.399026 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/./database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 8281) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m17:19:03.405912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7541998, "process_in_blocks": "0", "process_kernel_time": 0.193139, "process_mem_max_rss": "132972544", "process_out_blocks": "0", "process_user_time": 0.861147}
[0m17:19:03.406166 [debug] [MainThread]: Command `dbt run` failed at 17:19:03.406129 after 0.75 seconds
[0m17:19:03.406366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a90850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d3c5e0>]}
[0m17:19:03.406570 [debug] [MainThread]: Flushing usage events
[0m17:19:04.307360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:45.072454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4264c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a8370>]}


============================== 17:19:45.074616 | 5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8 ==============================
[0m17:19:45.074616 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:19:45.074878 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/davidhe/data-lab-new', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'True', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/davidhe/data-lab-new/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --debug', 'log_format': 'default'}
[0m17:19:45.188986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54c310>]}
[0m17:19:45.214317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad36730>]}
[0m17:19:45.215859 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:19:45.268953 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:19:45.340164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:45.340432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:45.343459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:19:45.353711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7d130>]}
[0m17:19:45.395092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:19:45.398126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:19:45.428091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba662e0>]}
[0m17:19:45.428443 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:19:45.428621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b64cd90>]}
[0m17:19:45.429258 [info ] [MainThread]: 
[0m17:19:45.429440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:45.429585 [info ] [MainThread]: 
[0m17:19:45.429838 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:19:45.430295 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:19:45.529834 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:19:45.530115 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:19:45.530285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:45.535465 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:19:45.536149 [debug] [ThreadPool]: On list_lab: Close
[0m17:19:45.536506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:19:45.536743 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:19:45.540295 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:19:45.540563 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:19:45.540727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:45.541274 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:19:45.541858 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:19:45.542030 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:19:45.542257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:45.542406 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:19:45.542549 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:19:45.542812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:45.543198 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:19:45.543362 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:19:45.543515 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:19:45.543723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:45.543880 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:19:45.544328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:19:45.546747 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:19:45.546934 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:19:45.547093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:45.547334 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:19:45.547489 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:19:45.547641 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:19:45.551349 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:19:45.551881 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:19:45.557192 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:19:45.557410 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:19:45.557854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba45250>]}
[0m17:19:45.558117 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:45.558274 [debug] [MainThread]: On master: BEGIN
[0m17:19:45.558418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:45.558843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:45.559069 [debug] [MainThread]: On master: COMMIT
[0m17:19:45.559250 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:45.559426 [debug] [MainThread]: On master: COMMIT
[0m17:19:45.559670 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:45.559836 [debug] [MainThread]: On master: Close
[0m17:19:45.561044 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:19:45.561308 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:19:45.561576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:19:45.561772 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:19:45.567038 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:19:45.570798 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:19:45.597270 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:19:45.600346 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.600555 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:19:45.600732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:45.601067 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.601237 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.601426 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
    
    

    create  table
      "lab"."main_silver"."silver_transform__dbt_tmp"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

    

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8' as _dbt_invocation_id

    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
    );
  
  
  
[0m17:19:45.603305 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:19:45.605761 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.605974 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_silver'
      AND table_name = 'silver_transform'
  
[0m17:19:45.606330 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.606901 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.607087 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_silver'
      AND table_name = 'silver_transform'
  
[0m17:19:45.607620 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.610683 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.610885 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter view "lab"."main_silver"."silver_transform" rename to "silver_transform__dbt_backup"
[0m17:19:45.611233 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.612534 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.612705 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
alter table "lab"."main_silver"."silver_transform__dbt_tmp" rename to "silver_transform"
[0m17:19:45.612968 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.619121 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:19:45.619322 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.619495 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:19:45.620287 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:19:45.620535 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.620708 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:19:45.620931 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.621097 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.621262 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_silver'
      AND table_name = 'silver_transform__dbt_backup'
  
[0m17:19:45.621568 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.622059 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.622341 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_silver'
      AND table_name = 'silver_transform__dbt_backup'
  
[0m17:19:45.622712 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.625825 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:19:45.626034 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main_silver"."silver_transform__dbt_backup" cascade
    
[0m17:19:45.626340 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:19:45.627409 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: ROLLBACK
[0m17:19:45.627643 [debug] [Thread-1  ]: Failed to rollback 'model.data_lab_new.silver_transform'
[0m17:19:45.627818 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:19:45.634714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d068c49-7d2a-4ab8-88fe-4bcfdf6fc6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc44c0>]}
[0m17:19:45.635047 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.07s]
[0m17:19:45.635310 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:19:45.635795 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:45.635962 [debug] [MainThread]: On master: BEGIN
[0m17:19:45.636110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:45.636359 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:45.636514 [debug] [MainThread]: On master: COMMIT
[0m17:19:45.636664 [debug] [MainThread]: Using duckdb connection "master"
[0m17:19:45.636809 [debug] [MainThread]: On master: COMMIT
[0m17:19:45.637000 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:19:45.637157 [debug] [MainThread]: On master: Close
[0m17:19:45.637339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:45.637483 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:19:45.637638 [info ] [MainThread]: 
[0m17:19:45.637786 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:19:45.638081 [debug] [MainThread]: Command end result
[0m17:19:45.658597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:19:45.661323 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:19:45.671489 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:19:45.671673 [info ] [MainThread]: 
[0m17:19:45.671864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:45.672015 [info ] [MainThread]: 
[0m17:19:45.672230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:19:45.673698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.660205, "process_in_blocks": "0", "process_kernel_time": 0.195544, "process_mem_max_rss": "143392768", "process_out_blocks": "0", "process_user_time": 0.941858}
[0m17:19:45.673929 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:45.673890 after 0.66 seconds
[0m17:19:45.674160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4264c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad36730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f1070>]}
[0m17:19:45.674408 [debug] [MainThread]: Flushing usage events
[0m17:19:46.697545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:55.507887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a502430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5854c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5852e0>]}


============================== 17:27:55.510297 | 0b26789f-d498-43e2-950d-df84d1acdf08 ==============================
[0m17:27:55.510297 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:27:55.510554 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/davidhe/data-lab-new', 'debug': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --debug', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False'}
[0m17:27:55.629061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b26789f-d498-43e2-950d-df84d1acdf08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65d3d0>]}
[0m17:27:55.654890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b26789f-d498-43e2-950d-df84d1acdf08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae522e0>]}
[0m17:27:55.656411 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:27:55.708715 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:27:55.777227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:55.777487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:55.780458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:27:55.791321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b26789f-d498-43e2-950d-df84d1acdf08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb5a130>]}
[0m17:27:55.832916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:27:55.836215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:27:55.856069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b26789f-d498-43e2-950d-df84d1acdf08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb82ca0>]}
[0m17:27:55.856391 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:27:55.856564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b26789f-d498-43e2-950d-df84d1acdf08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b772400>]}
[0m17:27:55.857191 [info ] [MainThread]: 
[0m17:27:55.857370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:55.857513 [info ] [MainThread]: 
[0m17:27:55.857759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:27:55.858204 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:27:55.955143 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:27:55.955412 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:27:55.955574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:55.959914 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:27:55.960119 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:27:55.960627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:55.960803 [debug] [MainThread]: Connection 'list_lab' was properly closed.
[0m17:27:55.960978 [info ] [MainThread]: 
[0m17:27:55.961142 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m17:27:55.961380 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/./database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 8281) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m17:27:55.962663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4906165, "process_in_blocks": "0", "process_kernel_time": 0.192409, "process_mem_max_rss": "132579328", "process_out_blocks": "0", "process_user_time": 0.842663}
[0m17:27:55.962880 [debug] [MainThread]: Command `dbt run` failed at 17:27:55.962839 after 0.49 seconds
[0m17:27:55.963155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a502430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb45970>]}
[0m17:27:55.963427 [debug] [MainThread]: Flushing usage events
[0m17:27:56.858374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:06.798447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a222430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2a44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2a42e0>]}


============================== 17:28:06.800541 | 412c342d-4ecb-40f6-861c-7f790ccee15c ==============================
[0m17:28:06.800541 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:28:06.800797 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --debug', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'True', 'log_cache_events': 'False', 'log_path': '/Users/davidhe/data-lab-new/logs', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:28:06.915700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37c3d0>]}
[0m17:28:06.941378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab742e0>]}
[0m17:28:06.943245 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:28:06.996204 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:28:07.069664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:07.069928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:07.072927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:28:07.083716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b865130>]}
[0m17:28:07.124103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:28:07.127602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:28:07.148674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88eca0>]}
[0m17:28:07.148963 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:28:07.149134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b492400>]}
[0m17:28:07.149732 [info ] [MainThread]: 
[0m17:28:07.149908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:07.150050 [info ] [MainThread]: 
[0m17:28:07.150294 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:28:07.150756 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:28:07.247755 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:28:07.248034 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:28:07.248193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:07.253501 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:28:07.254064 [debug] [ThreadPool]: On list_lab: Close
[0m17:28:07.254467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:28:07.254743 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:28:07.257935 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:28:07.258114 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:28:07.258265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:07.258686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:07.259284 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:28:07.259486 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:28:07.259732 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:07.259888 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:28:07.260036 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:28:07.260269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:07.260616 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:28:07.260772 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:28:07.260917 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:28:07.261115 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:07.261272 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:28:07.261729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:28:07.264414 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:28:07.264657 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:28:07.264824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:07.265098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:28:07.265245 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:28:07.265401 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:28:07.269209 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:28:07.269784 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:28:07.270859 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:28:07.271018 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:28:07.271423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8369a0>]}
[0m17:28:07.271667 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.271828 [debug] [MainThread]: On master: BEGIN
[0m17:28:07.271971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:07.272227 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:28:07.272379 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.272525 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.272669 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.272895 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:28:07.273066 [debug] [MainThread]: On master: Close
[0m17:28:07.274251 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:28:07.274501 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:28:07.274766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:28:07.274947 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:28:07.281336 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:28:07.284637 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:28:07.307815 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.308073 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      drop view if exists "lab"."main_silver"."silver_transform__dbt_backup" cascade
    
[0m17:28:07.308253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:07.309030 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:28:07.314201 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.314499 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119172807300944"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

    
        -- Only read new orders since last run
        where order_date > (
            select max(most_recent_order_date)
            from "lab"."main_silver"."silver_transform"
        )
    

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '412c342d-4ecb-40f6-861c-7f790ccee15c' as _dbt_invocation_id

    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
    );
  
  
  
[0m17:28:07.316036 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:28:07.319187 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.319410 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:28:07.319699 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:28:07.319877 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.320123 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260119172807300944'
      
      
      order by ordinal_position

  
[0m17:28:07.321441 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:28:07.323641 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.323839 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:28:07.324761 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:28:07.328605 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.328820 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:28:07.329705 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:28:07.330348 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.330527 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:28:07.330777 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:28:07.337037 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:28:07.345382 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.345585 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119172807300944"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119172807300944"
    )
  
[0m17:28:07.346504 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:28:07.350879 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:28:07.351100 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:28:07.351276 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:28:07.351883 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:28:07.352761 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:28:07.353919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412c342d-4ecb-40f6-861c-7f790ccee15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87a700>]}
[0m17:28:07.354246 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m17:28:07.354496 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:28:07.354974 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.355149 [debug] [MainThread]: On master: BEGIN
[0m17:28:07.355300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:07.355557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:28:07.355728 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.355879 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:07.356027 [debug] [MainThread]: On master: COMMIT
[0m17:28:07.356262 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:28:07.356453 [debug] [MainThread]: On master: Close
[0m17:28:07.356658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:07.356808 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:28:07.356968 [info ] [MainThread]: 
[0m17:28:07.357124 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:28:07.357431 [debug] [MainThread]: Command end result
[0m17:28:07.375012 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:28:07.377707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:28:07.388110 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:28:07.388291 [info ] [MainThread]: 
[0m17:28:07.388477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:07.388622 [info ] [MainThread]: 
[0m17:28:07.388777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:28:07.390114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.660554, "process_in_blocks": "0", "process_kernel_time": 0.202929, "process_mem_max_rss": "146128896", "process_out_blocks": "0", "process_user_time": 0.955471}
[0m17:28:07.390318 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:07.390282 after 0.66 seconds
[0m17:28:07.390513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a222430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab742e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d01f0>]}
[0m17:28:07.390706 [debug] [MainThread]: Flushing usage events
[0m17:28:08.451682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:32.703438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ff490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ff2b0>]}


============================== 17:33:32.706054 | 50afcbda-c8c8-4f96-a030-9497d0995a4f ==============================
[0m17:33:32.706054 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:33:32.706303 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'version_check': 'True', 'invocation_command': 'dbt run --debug', 'use_experimental_parser': 'False', 'debug': 'True', 'introspect': 'True', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default'}
[0m17:33:32.821793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b589070>]}
[0m17:33:32.847686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c60d0>]}
[0m17:33:32.849485 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:33:32.905051 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:33:32.975995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:32.976253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:32.979379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:33:32.990209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad5130>]}
[0m17:33:33.033069 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:33:33.036497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:33:33.059460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bafe760>]}
[0m17:33:33.059784 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:33:33.059953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba93a00>]}
[0m17:33:33.060544 [info ] [MainThread]: 
[0m17:33:33.060715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:33.060850 [info ] [MainThread]: 
[0m17:33:33.061090 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:33:33.061542 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:33:33.155731 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:33:33.156001 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:33:33.156168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:33.161453 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:33:33.162084 [debug] [ThreadPool]: On list_lab: Close
[0m17:33:33.162469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:33:33.162754 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:33:33.166070 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:33:33.166278 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:33:33.166430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:33.166913 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:33.168393 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:33:33.168591 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:33:33.168852 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:33.169024 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:33:33.169179 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:33:33.169798 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:33.170170 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:33:33.170336 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:33:33.170478 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:33:33.170684 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:33.170840 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:33:33.171273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:33:33.173850 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:33:33.174024 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:33:33.174174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:33.174400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:33.174555 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:33:33.174708 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:33:33.178428 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:33:33.179006 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:33:33.180159 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:33:33.180321 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:33:33.180722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ed640>]}
[0m17:33:33.180997 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:33.181149 [debug] [MainThread]: On master: BEGIN
[0m17:33:33.181293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:33.181568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:33.181721 [debug] [MainThread]: On master: COMMIT
[0m17:33:33.181865 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:33.182010 [debug] [MainThread]: On master: COMMIT
[0m17:33:33.182212 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:33.182363 [debug] [MainThread]: On master: Close
[0m17:33:33.183454 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:33:33.183775 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:33:33.184067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:33:33.184263 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:33:33.190427 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:33:33.194031 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:33:33.219826 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:33:33.220134 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119173333210336"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,

        case
            
                when c.first_name != t.first_name
                    then current_timestamp
                else t.updated
            
        end as updated,

        current_timestamp as _dbt_loaded_at,
        '50afcbda-c8c8-4f96-a030-9497d0995a4f' as _dbt_invocation_id

    from customers as c
    left join customer_orders as co
        on c.customer_id = co.customer_id

    
        left join "lab"."main_silver"."silver_transform" as t
            on c.customer_id = t.customer_id
    
)

select * from final
    );
  
  
  
[0m17:33:33.220379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:33:33.223338 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119173333210336"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from lab.bronze.orders

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,

        case
            
                when c.first_name != t.first_name
                    then current_timestamp
                else t.updated
            
        end as updated,

        current_timestamp as _dbt_loaded_at,
        '50afcbda-c8c8-4f96-a030-9497d0995a4f' as _dbt_invocation_id

    from customers as c
    left join customer_orders as co
        on c.customer_id = co.customer_id

    
        left join "lab"."main_silver"."silver_transform" as t
            on c.customer_id = t.customer_id
    
)

select * from final
    );
  
  
  
[0m17:33:33.223588 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m17:33:33.223840 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:33:33.286446 [debug] [Thread-1  ]: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Binder Error: Table "t" does not have a column named "updated"
  
  Candidate bindings: : "customer_id"
  
  LINE 61:                 else t.updated
                                ^
[0m17:33:33.287813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50afcbda-c8c8-4f96-a030-9497d0995a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb83e20>]}
[0m17:33:33.288217 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model main_silver.silver_transform ....... [[31mERROR[0m in 0.10s]
[0m17:33:33.288513 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:33:33.288813 [debug] [Thread-4  ]: Marking all children of 'model.data_lab_new.silver_transform' to be skipped because of status 'error'.  Reason: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Binder Error: Table "t" does not have a column named "updated"
  
  Candidate bindings: : "customer_id"
  
  LINE 61:                 else t.updated
                                ^.
[0m17:33:33.289388 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:33.289597 [debug] [MainThread]: On master: BEGIN
[0m17:33:33.289766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:33.290088 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:33.290261 [debug] [MainThread]: On master: COMMIT
[0m17:33:33.290426 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:33.290586 [debug] [MainThread]: On master: COMMIT
[0m17:33:33.290821 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:33.291013 [debug] [MainThread]: On master: Close
[0m17:33:33.291233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:33.291394 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:33:33.291565 [info ] [MainThread]: 
[0m17:33:33.291803 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:33:33.292152 [debug] [MainThread]: Command end result
[0m17:33:33.308162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:33:33.309612 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:33:33.316382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:33:33.316595 [info ] [MainThread]: 
[0m17:33:33.316780 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:33:33.316939 [info ] [MainThread]: 
[0m17:33:33.317120 [error] [MainThread]: [31mFailure in model silver_transform (models/silver/silver_transform.sql)[0m
[0m17:33:33.317295 [error] [MainThread]:   Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Binder Error: Table "t" does not have a column named "updated"
  
  Candidate bindings: : "customer_id"
  
  LINE 61:                 else t.updated
                                ^
[0m17:33:33.317438 [info ] [MainThread]: 
[0m17:33:33.317602 [info ] [MainThread]:   compiled code at target/compiled/data_lab_new/models/silver/silver_transform.sql
[0m17:33:33.317744 [info ] [MainThread]: 
[0m17:33:33.317898 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:33:33.319359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6528342, "process_in_blocks": "0", "process_kernel_time": 0.195481, "process_mem_max_rss": "141459456", "process_out_blocks": "0", "process_user_time": 0.953464}
[0m17:33:33.319566 [debug] [MainThread]: Command `dbt run` failed at 17:33:33.319529 after 0.65 seconds
[0m17:33:33.319769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bafe220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a725a30>]}
[0m17:33:33.319965 [debug] [MainThread]: Flushing usage events
[0m17:33:34.294164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:01.704760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d679460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d679280>]}


============================== 17:37:01.707308 | becbfd9e-0e21-463c-b4aa-00e0056447bb ==============================
[0m17:37:01.707308 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:37:01.707576 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/davidhe/data-lab-new', 'quiet': 'False', 'invocation_command': 'dbt run --debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'debug': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False'}
[0m17:37:01.826691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb93a0>]}
[0m17:37:01.852420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d61b4f0>]}
[0m17:37:01.854183 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:37:01.912037 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:37:01.987082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:37:01.987340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:37:01.990375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:37:02.001231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc39130>]}
[0m17:37:02.042310 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:37:02.045932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:37:02.078722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc627c0>]}
[0m17:37:02.079048 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:37:02.079217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc01040>]}
[0m17:37:02.079821 [info ] [MainThread]: 
[0m17:37:02.079996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:02.080135 [info ] [MainThread]: 
[0m17:37:02.080378 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:02.080823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:37:02.184499 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:37:02.184765 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:37:02.184923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:02.190401 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:37:02.191010 [debug] [ThreadPool]: On list_lab: Close
[0m17:37:02.191402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:37:02.191665 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:37:02.195003 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:37:02.195217 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:37:02.195392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:02.195853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.196402 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:37:02.196563 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:37:02.196780 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.196931 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:37:02.197075 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:37:02.197295 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.197632 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:37:02.197788 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:37:02.197931 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:37:02.198126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.198279 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:37:02.198712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:37:02.201127 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:37:02.201298 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:37:02.201534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:02.201799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.201956 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:37:02.202126 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:37:02.205860 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:37:02.206438 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:37:02.207407 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:37:02.207561 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:37:02.207921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc42760>]}
[0m17:37:02.208206 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:02.208365 [debug] [MainThread]: On master: BEGIN
[0m17:37:02.208507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:02.208742 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:02.208886 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.209111 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:02.209375 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.209612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:02.209773 [debug] [MainThread]: On master: Close
[0m17:37:02.210970 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:37:02.211261 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:37:02.211537 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:37:02.211724 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:37:02.217823 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:37:02.221574 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:37:02.247492 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.247769 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119173702238021"
  
    as (
      

with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date
    from lab.bronze.orders

    
        -- Only read orders newer than what we've already processed
        where order_date > (
            select max(most_recent_order_date)
            from "lab"."main_silver"."silver_transform"
        )
    

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

)

select
    customer_id,
    first_order_date,
    most_recent_order_date,
    number_of_orders,
    current_timestamp as _dbt_loaded_at,
    'becbfd9e-0e21-463c-b4aa-00e0056447bb' as _dbt_invocation_id
from customer_orders
    );
  
  
  
[0m17:37:02.247992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:02.256019 [debug] [Thread-1  ]: SQL status: OK in 0.008 seconds
[0m17:37:02.259864 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.260113 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:37:02.260408 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:02.260586 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.260766 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260119173702238021'
      
      
      order by ordinal_position

  
[0m17:37:02.263668 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m17:37:02.266127 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.266333 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:37:02.267270 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:37:02.270735 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.270938 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:37:02.271846 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:37:02.272530 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.272724 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:37:02.272989 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:02.280063 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:37:02.286609 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:37:02.286818 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119173702238021"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119173702238021"
    )
  
[0m17:37:02.289319 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119173702238021"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119173702238021"
    )
  
[0m17:37:02.289544 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m17:37:02.289821 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: ROLLBACK
[0m17:37:02.302474 [debug] [Thread-1  ]: Failed to rollback 'model.data_lab_new.silver_transform'
[0m17:37:02.302710 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:37:02.305108 [debug] [Thread-1  ]: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Binder Error: Referenced column "first_name" not found in FROM clause!
  Candidate bindings: "first_order_date", "customer_id", "most_recent_order_date", "_dbt_invocation_id"
[0m17:37:02.306378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'becbfd9e-0e21-463c-b4aa-00e0056447bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df78460>]}
[0m17:37:02.306722 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model main_silver.silver_transform ....... [[31mERROR[0m in 0.09s]
[0m17:37:02.306970 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:37:02.307223 [debug] [Thread-4  ]: Marking all children of 'model.data_lab_new.silver_transform' to be skipped because of status 'error'.  Reason: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Binder Error: Referenced column "first_name" not found in FROM clause!
  Candidate bindings: "first_order_date", "customer_id", "most_recent_order_date", "_dbt_invocation_id".
[0m17:37:02.307746 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:02.307908 [debug] [MainThread]: On master: BEGIN
[0m17:37:02.308051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:02.308333 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:02.308484 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.308626 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:02.308843 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.309290 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:02.309468 [debug] [MainThread]: On master: Close
[0m17:37:02.309677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:02.309820 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:37:02.309978 [info ] [MainThread]: 
[0m17:37:02.310130 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:37:02.310415 [debug] [MainThread]: Command end result
[0m17:37:02.332900 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:37:02.335759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:37:02.344321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:37:02.344540 [info ] [MainThread]: 
[0m17:37:02.344720 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:37:02.344874 [info ] [MainThread]: 
[0m17:37:02.345048 [error] [MainThread]: [31mFailure in model silver_transform (models/silver/silver_transform.sql)[0m
[0m17:37:02.345218 [error] [MainThread]:   Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Binder Error: Referenced column "first_name" not found in FROM clause!
  Candidate bindings: "first_order_date", "customer_id", "most_recent_order_date", "_dbt_invocation_id"
[0m17:37:02.345354 [info ] [MainThread]: 
[0m17:37:02.345510 [info ] [MainThread]:   compiled code at target/compiled/data_lab_new/models/silver/silver_transform.sql
[0m17:37:02.345644 [info ] [MainThread]: 
[0m17:37:02.345794 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:37:02.347309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6808828, "process_in_blocks": "0", "process_kernel_time": 0.204452, "process_mem_max_rss": "143409152", "process_out_blocks": "0", "process_user_time": 0.957386}
[0m17:37:02.347506 [debug] [MainThread]: Command `dbt run` failed at 17:37:02.347469 after 0.68 seconds
[0m17:37:02.347701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc2b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb93a0>]}
[0m17:37:02.347893 [debug] [MainThread]: Flushing usage events
[0m17:37:03.295289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:04.136477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109564490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095642b0>]}


============================== 17:38:04.138769 | 2c5b69c9-ac94-4864-bb72-1fa66db16387 ==============================
[0m17:38:04.138769 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:38:04.139057 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/davidhe/data-lab-new/logs', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --debug', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'debug': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'no_print': 'None'}
[0m17:38:04.257516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da5820>]}
[0m17:38:04.285721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109536ee0>]}
[0m17:38:04.286989 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:38:04.347073 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:38:04.413196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:04.413488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:04.416710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:38:04.428140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b26130>]}
[0m17:38:04.466838 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:38:04.470153 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:38:04.485578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0df10>]}
[0m17:38:04.485908 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:38:04.486071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3faf0>]}
[0m17:38:04.486695 [info ] [MainThread]: 
[0m17:38:04.486876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:04.487017 [info ] [MainThread]: 
[0m17:38:04.487278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:04.487769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:38:04.579375 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:38:04.579639 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:38:04.579803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:04.585368 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:38:04.586045 [debug] [ThreadPool]: On list_lab: Close
[0m17:38:04.586395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:38:04.586621 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:38:04.589789 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:04.590020 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:38:04.590229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:04.590669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:04.591223 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:04.591408 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:38:04.591644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:04.591792 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:04.591940 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:38:04.592157 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:04.592512 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:38:04.592668 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:04.592842 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:38:04.593095 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:04.593302 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:38:04.593873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:38:04.597079 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:38:04.597269 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:38:04.597415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:04.597679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:04.597830 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:38:04.597978 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:38:04.601970 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:38:04.602621 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:38:04.603567 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:38:04.603727 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:38:04.604115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109747220>]}
[0m17:38:04.604359 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:04.604532 [debug] [MainThread]: On master: BEGIN
[0m17:38:04.604684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:04.604938 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:04.605084 [debug] [MainThread]: On master: COMMIT
[0m17:38:04.605227 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:04.605370 [debug] [MainThread]: On master: COMMIT
[0m17:38:04.605571 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:04.605732 [debug] [MainThread]: On master: Close
[0m17:38:04.606856 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:38:04.607115 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:38:04.607377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:38:04.607573 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:38:04.614526 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:38:04.617086 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:38:04.644707 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.645008 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119173804634801"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

    
        -- Only read new orders since last run
        where order_date > (
            select max(most_recent_order_date)
            from "lab"."main_silver"."silver_transform"
        )
    

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '2c5b69c9-ac94-4864-bb72-1fa66db16387' as _dbt_invocation_id

    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
    );
  
  
  
[0m17:38:04.645247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:38:04.647461 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:38:04.650908 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.651126 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:38:04.651431 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:38:04.651612 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.651793 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260119173804634801'
      
      
      order by ordinal_position

  
[0m17:38:04.652736 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:04.655052 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.655256 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:38:04.656120 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:04.659620 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.659846 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:38:04.660780 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:04.661603 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.661817 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:38:04.662105 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:38:04.669179 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:38:04.671337 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.671538 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119173804634801"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119173804634801"
    )
  
[0m17:38:04.673108 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:04.677446 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:38:04.677675 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:04.677859 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:38:04.679032 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:04.679971 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:38:04.681034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5b69c9-ac94-4864-bb72-1fa66db16387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6c130>]}
[0m17:38:04.681380 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.07s]
[0m17:38:04.681637 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:38:04.682156 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:04.682328 [debug] [MainThread]: On master: BEGIN
[0m17:38:04.682479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:04.682745 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:04.682904 [debug] [MainThread]: On master: COMMIT
[0m17:38:04.683054 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:04.683198 [debug] [MainThread]: On master: COMMIT
[0m17:38:04.683394 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:04.683544 [debug] [MainThread]: On master: Close
[0m17:38:04.683734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:04.683879 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:38:04.684037 [info ] [MainThread]: 
[0m17:38:04.684188 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m17:38:04.684490 [debug] [MainThread]: Command end result
[0m17:38:04.697211 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:38:04.698745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:38:04.704126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:38:04.704333 [info ] [MainThread]: 
[0m17:38:04.704530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:04.704679 [info ] [MainThread]: 
[0m17:38:04.704843 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:38:04.706205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.62285507, "process_in_blocks": "0", "process_kernel_time": 0.200147, "process_mem_max_rss": "146407424", "process_out_blocks": "0", "process_user_time": 1.017121}
[0m17:38:04.706416 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:04.706378 after 0.62 seconds
[0m17:38:04.706614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109536ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098013d0>]}
[0m17:38:04.706815 [debug] [MainThread]: Flushing usage events
[0m17:38:05.759119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:15.104926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8de460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9604c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9602e0>]}


============================== 17:38:15.107002 | 37133127-134e-491b-8fdc-f1904c178290 ==============================
[0m17:38:15.107002 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:38:15.107268 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --debug', 'fail_fast': 'False', 'empty': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/davidhe/data-lab-new/logs', 'debug': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default'}
[0m17:38:15.216552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da56dc0>]}
[0m17:38:15.259427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92ee50>]}
[0m17:38:15.260904 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:38:15.318615 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:38:15.382839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:15.383104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:15.386225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:38:15.397224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df22130>]}
[0m17:38:15.434846 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:38:15.436914 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:38:15.450323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4ab50>]}
[0m17:38:15.450664 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:38:15.450837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd8c220>]}
[0m17:38:15.451513 [info ] [MainThread]: 
[0m17:38:15.451700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:15.451847 [info ] [MainThread]: 
[0m17:38:15.452102 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:15.452579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:38:15.540606 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:38:15.540885 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:38:15.541052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:15.546454 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:38:15.547107 [debug] [ThreadPool]: On list_lab: Close
[0m17:38:15.547447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:38:15.547672 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:38:15.551229 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:15.551463 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:38:15.551626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:15.552130 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:15.552765 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:15.552941 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:38:15.553196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:15.553354 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:15.553519 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:38:15.553758 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:15.554122 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:38:15.554286 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:15.554442 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:38:15.554649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:15.554815 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:38:15.555295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:38:15.557942 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:38:15.558119 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:38:15.558266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:15.558496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:15.558648 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:38:15.558808 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:38:15.563046 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:38:15.563718 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:38:15.564636 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:38:15.564798 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:38:15.565166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4ac10>]}
[0m17:38:15.565414 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:15.565572 [debug] [MainThread]: On master: BEGIN
[0m17:38:15.565718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:15.566010 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:15.566170 [debug] [MainThread]: On master: COMMIT
[0m17:38:15.566327 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:15.566473 [debug] [MainThread]: On master: COMMIT
[0m17:38:15.566685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:15.566850 [debug] [MainThread]: On master: Close
[0m17:38:15.567946 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:38:15.568235 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:38:15.568507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:38:15.568698 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:38:15.575093 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:38:15.577905 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:38:15.605236 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.605542 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119173815595198"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

    
        -- Only read new orders since last run
        where order_date > (
            select max(most_recent_order_date)
            from "lab"."main_silver"."silver_transform"
        )
    

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '37133127-134e-491b-8fdc-f1904c178290' as _dbt_invocation_id

    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
    );
  
  
  
[0m17:38:15.605787 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:38:15.607278 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:15.610753 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.610966 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:38:15.611288 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:38:15.611485 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.611697 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260119173815595198'
      
      
      order by ordinal_position

  
[0m17:38:15.612649 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:15.614900 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.615105 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:38:15.615963 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:15.619387 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.619598 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:38:15.620459 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:15.621121 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.621308 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:38:15.621573 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:38:15.628426 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:38:15.630757 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.631029 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119173815595198"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119173815595198"
    )
  
[0m17:38:15.632083 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:15.636952 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:38:15.637170 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:15.637348 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:38:15.638173 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:15.639186 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:38:15.640157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37133127-134e-491b-8fdc-f1904c178290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e268130>]}
[0m17:38:15.640495 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.07s]
[0m17:38:15.640754 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:38:15.641262 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:15.641445 [debug] [MainThread]: On master: BEGIN
[0m17:38:15.641598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:15.641874 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:15.642046 [debug] [MainThread]: On master: COMMIT
[0m17:38:15.642194 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:15.642339 [debug] [MainThread]: On master: COMMIT
[0m17:38:15.642539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:15.642688 [debug] [MainThread]: On master: Close
[0m17:38:15.642889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:15.643039 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:38:15.643196 [info ] [MainThread]: 
[0m17:38:15.643342 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:38:15.643636 [debug] [MainThread]: Command end result
[0m17:38:15.656554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:38:15.657880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:38:15.663462 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:38:15.663691 [info ] [MainThread]: 
[0m17:38:15.663888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:15.664036 [info ] [MainThread]: 
[0m17:38:15.664194 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:38:15.665443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6286177, "process_in_blocks": "0", "process_kernel_time": 0.201614, "process_mem_max_rss": "146259968", "process_out_blocks": "0", "process_user_time": 0.996292}
[0m17:38:15.665655 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:15.665615 after 0.63 seconds
[0m17:38:15.665851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8de460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4abe0>]}
[0m17:38:15.666051 [debug] [MainThread]: Flushing usage events
[0m17:38:16.713695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:27.986414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938d370>]}


============================== 17:40:27.989094 | 99283b3a-f20e-4ebc-a135-9bf32bac9f7d ==============================
[0m17:40:27.989094 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:40:27.989370 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --debug', 'debug': 'True', 'warn_error': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/davidhe/data-lab-new/logs', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m17:40:28.174791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942dd00>]}
[0m17:40:28.204367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1a730>]}
[0m17:40:28.206055 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:40:28.272948 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:40:28.348248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:28.348514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:28.352084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:40:28.363708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994e130>]}
[0m17:40:28.401494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:40:28.405424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:40:28.424702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099362e0>]}
[0m17:40:28.425074 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:40:28.425255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952fd90>]}
[0m17:40:28.425972 [info ] [MainThread]: 
[0m17:40:28.426157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:28.426301 [info ] [MainThread]: 
[0m17:40:28.426562 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:28.427091 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:40:28.539976 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:40:28.540255 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:40:28.540426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:28.560086 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:40:28.561983 [debug] [ThreadPool]: On list_lab: Close
[0m17:40:28.562893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:40:28.563542 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:40:28.569559 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:40:28.569998 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:40:28.570234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:28.570952 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:40:28.571778 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:40:28.572005 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:40:28.572535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:28.572932 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:40:28.573510 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:40:28.575392 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:28.577076 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:40:28.577346 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:40:28.577516 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:40:28.577796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:28.577963 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:40:28.578511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:40:28.581544 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:40:28.581743 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:40:28.581892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:28.582168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:28.582318 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:40:28.582468 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:40:28.588726 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:40:28.589585 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:40:28.590857 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:40:28.591015 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:40:28.591420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109917250>]}
[0m17:40:28.591688 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:28.591850 [debug] [MainThread]: On master: BEGIN
[0m17:40:28.591995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:28.592253 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:28.592404 [debug] [MainThread]: On master: COMMIT
[0m17:40:28.592552 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:28.592694 [debug] [MainThread]: On master: COMMIT
[0m17:40:28.592891 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:28.593041 [debug] [MainThread]: On master: Close
[0m17:40:28.594900 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:40:28.595172 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:40:28.595456 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:40:28.595638 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:40:28.602725 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:40:28.605948 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:40:28.634577 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.634916 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119174028624293"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

    
        -- Only read new orders since last run
        where order_date > (
            select max(most_recent_order_date)
            from "lab"."main_silver"."silver_transform"
        )
    

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '99283b3a-f20e-4ebc-a135-9bf32bac9f7d' as _dbt_invocation_id

    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
    );
  
  
  
[0m17:40:28.635204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:28.643533 [debug] [Thread-1  ]: SQL status: OK in 0.008 seconds
[0m17:40:28.647550 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.647802 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:40:28.648114 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:40:28.648296 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.648516 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260119174028624293'
      
      
      order by ordinal_position

  
[0m17:40:28.650609 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:40:28.653798 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.654060 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:40:28.655434 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:40:28.659366 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.659616 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:40:28.660724 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:40:28.661518 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.661713 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:40:28.661994 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:40:28.669698 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:40:28.671813 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.672046 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119174028624293"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119174028624293"
    )
  
[0m17:40:28.673690 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:40:28.678551 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:40:28.678851 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:40:28.679037 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:40:28.680300 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:40:28.681303 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:40:28.682507 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99283b3a-f20e-4ebc-a135-9bf32bac9f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c954c0>]}
[0m17:40:28.682885 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m17:40:28.683145 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:40:28.683772 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:28.683953 [debug] [MainThread]: On master: BEGIN
[0m17:40:28.684164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:28.684535 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:28.684699 [debug] [MainThread]: On master: COMMIT
[0m17:40:28.684853 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:28.684998 [debug] [MainThread]: On master: COMMIT
[0m17:40:28.685217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:28.685380 [debug] [MainThread]: On master: Close
[0m17:40:28.685580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:28.685724 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:40:28.685885 [info ] [MainThread]: 
[0m17:40:28.686034 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:40:28.686405 [debug] [MainThread]: Command end result
[0m17:40:28.699145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:40:28.700977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:40:28.706669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:40:28.706941 [info ] [MainThread]: 
[0m17:40:28.707153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:28.707309 [info ] [MainThread]: 
[0m17:40:28.707475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:40:28.709346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.779422, "process_in_blocks": "0", "process_kernel_time": 0.2517, "process_mem_max_rss": "146227200", "process_out_blocks": "0", "process_user_time": 1.028896}
[0m17:40:28.709576 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:28.709535 after 0.78 seconds
[0m17:40:28.709779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d4070>]}
[0m17:40:28.709984 [debug] [MainThread]: Flushing usage events
[0m17:40:29.683352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:32.984335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff12e0>]}


============================== 17:44:32.987039 | 669d3d86-a199-43e3-8427-076db998ec16 ==============================
[0m17:44:32.987039 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:44:32.987306 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run --debug', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'False', 'warn_error': 'None', 'log_path': '/Users/davidhe/data-lab-new/logs', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:33.164749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c93d0>]}
[0m17:44:33.191345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c02e0>]}
[0m17:44:33.193793 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:44:33.248723 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:44:33.332844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:33.333090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:33.336164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:44:33.346808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b1130>]}
[0m17:44:33.386849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:44:33.395038 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:44:33.425997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095daca0>]}
[0m17:44:33.426334 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:44:33.426506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091dc400>]}
[0m17:44:33.427127 [info ] [MainThread]: 
[0m17:44:33.427308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:33.427454 [info ] [MainThread]: 
[0m17:44:33.427711 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:44:33.428178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:44:33.529447 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:44:33.529701 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:44:33.529864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:33.541363 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:44:33.542100 [debug] [ThreadPool]: On list_lab: Close
[0m17:44:33.542447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:44:33.542678 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:44:33.545781 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:44:33.545979 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:44:33.546194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:33.546629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:33.547181 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:44:33.547336 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:44:33.547570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:33.547784 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:44:33.547936 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:44:33.548180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:33.548538 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:44:33.548779 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:44:33.548957 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:44:33.549193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:33.549358 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:44:33.549836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:44:33.552565 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:44:33.552770 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:44:33.552922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:33.553158 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:33.553309 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:44:33.553465 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:44:33.558311 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:44:33.559084 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:44:33.560369 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:44:33.560534 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:44:33.560913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095819a0>]}
[0m17:44:33.561173 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:33.561336 [debug] [MainThread]: On master: BEGIN
[0m17:44:33.561485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:33.561719 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:33.561873 [debug] [MainThread]: On master: COMMIT
[0m17:44:33.562025 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:33.562173 [debug] [MainThread]: On master: COMMIT
[0m17:44:33.562419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:33.562588 [debug] [MainThread]: On master: Close
[0m17:44:33.564199 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:44:33.564470 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:44:33.564753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:44:33.564973 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:44:33.571550 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:44:33.575766 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:44:33.602260 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.602556 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260119174433592549"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from lab.bronze.orders

    
        -- Only read new orders since last run
        where order_date > (
            select max(most_recent_order_date)
            from "lab"."main_silver"."silver_transform"
        )
    

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '669d3d86-a199-43e3-8427-076db998ec16' as _dbt_invocation_id

    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
    );
  
  
  
[0m17:44:33.602794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:33.609200 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m17:44:33.612421 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.612628 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:44:33.612886 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:44:33.613062 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.613270 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260119174433592549'
      
      
      order by ordinal_position

  
[0m17:44:33.614887 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:44:33.617788 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.618015 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:44:33.619031 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:44:33.622458 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.622678 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:44:33.623628 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:44:33.624308 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.624485 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:44:33.624750 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:44:33.631677 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:44:33.638887 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.639102 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260119174433592549"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260119174433592549"
    )
  
[0m17:44:33.640652 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:44:33.644935 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:44:33.645148 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:44:33.645322 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:44:33.646422 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:44:33.647323 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:44:33.648763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '669d3d86-a199-43e3-8427-076db998ec16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f95b0>]}
[0m17:44:33.649131 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m17:44:33.649388 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:44:33.649875 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:33.650063 [debug] [MainThread]: On master: BEGIN
[0m17:44:33.650248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:33.650526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:33.650687 [debug] [MainThread]: On master: COMMIT
[0m17:44:33.650838 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:33.650987 [debug] [MainThread]: On master: COMMIT
[0m17:44:33.651207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:33.651359 [debug] [MainThread]: On master: Close
[0m17:44:33.651556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:33.651704 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:44:33.651861 [info ] [MainThread]: 
[0m17:44:33.652013 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m17:44:33.652313 [debug] [MainThread]: Command end result
[0m17:44:33.671789 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:44:33.674503 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:44:33.684399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:44:33.684588 [info ] [MainThread]: 
[0m17:44:33.684774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:33.684920 [info ] [MainThread]: 
[0m17:44:33.685075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:44:33.686551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.79150164, "process_in_blocks": "0", "process_kernel_time": 0.234423, "process_mem_max_rss": "145883136", "process_out_blocks": "0", "process_user_time": 0.959718}
[0m17:44:33.686757 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:33.686719 after 0.79 seconds
[0m17:44:33.686953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106832790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dac10>]}
[0m17:44:33.687147 [debug] [MainThread]: Flushing usage events
[0m17:44:34.669077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:49.055480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ba460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3d280>]}


============================== 15:47:49.058176 | 96bc2477-235d-4d7d-bd55-16e52551de7e ==============================
[0m15:47:49.058176 [info ] [MainThread]: Running with dbt=1.10.18
[0m15:47:49.058501 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/davidhe/data-lab-new', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:47:49.196617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96bc2477-235d-4d7d-bd55-16e52551de7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d1a30>]}
[0m15:47:49.254746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96bc2477-235d-4d7d-bd55-16e52551de7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b4f70>]}
[0m15:47:49.256490 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:47:49.342211 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m15:47:49.408789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:49.409053 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:49.412576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m15:47:49.425532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96bc2477-235d-4d7d-bd55-16e52551de7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c012130>]}
[0m15:47:49.462215 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m15:47:49.469284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m15:47:49.540802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96bc2477-235d-4d7d-bd55-16e52551de7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfe13d0>]}
[0m15:47:49.541120 [info ] [MainThread]: Found 1 model, 456 macros
[0m15:47:49.541849 [info ] [MainThread]: 
[0m15:47:49.542029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:49.542177 [info ] [MainThread]: 
[0m15:47:49.542422 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:47:49.542838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m15:47:49.617515 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m15:47:49.617777 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m15:47:49.617934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:49.623860 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m15:47:49.624590 [debug] [ThreadPool]: On list_lab: Close
[0m15:47:49.624932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m15:47:49.625158 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m15:47:49.628686 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m15:47:49.628861 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m15:47:49.629004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:49.629408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:49.630002 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m15:47:49.630149 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m15:47:49.630348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:49.630483 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m15:47:49.630617 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m15:47:49.630842 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:49.631369 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m15:47:49.631776 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m15:47:49.632106 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m15:47:49.632644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:49.632866 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m15:47:49.633493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m15:47:49.636474 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m15:47:49.636690 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m15:47:49.636839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:49.637157 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:49.637298 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m15:47:49.637441 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m15:47:49.641661 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:47:49.642351 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m15:47:49.643391 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m15:47:49.643564 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m15:47:49.643987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96bc2477-235d-4d7d-bd55-16e52551de7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c178ca0>]}
[0m15:47:49.644242 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:49.644397 [debug] [MainThread]: On master: BEGIN
[0m15:47:49.644537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:49.644832 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:47:49.644982 [debug] [MainThread]: On master: COMMIT
[0m15:47:49.645124 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:49.645287 [debug] [MainThread]: On master: COMMIT
[0m15:47:49.645510 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:47:49.645662 [debug] [MainThread]: On master: Close
[0m15:47:49.646860 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m15:47:49.647122 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m15:47:49.647336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m15:47:49.647601 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m15:47:49.655196 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m15:47:49.658569 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m15:47:49.686655 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.686950 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122154749676093"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from lab.bronze.orders

    
        where order_date > (
            select max(t.most_recent_order_date)
            from "lab"."main_silver"."silver_transform" as t
        )
    

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '96bc2477-235d-4d7d-bd55-16e52551de7e' as _dbt_invocation_id
    from customers as c
    left join customer_orders as co
        on c.customer_id = co.customer_id

)

select *
from final


    where customer_id in (
        select co.customer_id
        from customer_orders as co
    )

    );
  
  
  
[0m15:47:49.687159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:49.689572 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m15:47:49.693571 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.693765 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m15:47:49.694016 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:47:49.694180 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.694348 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122154749676093'
      
      
      order by ordinal_position

  
[0m15:47:49.695436 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m15:47:49.698187 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.698642 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m15:47:49.699867 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m15:47:49.703628 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.703846 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m15:47:49.704824 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m15:47:49.705599 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.705800 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m15:47:49.706065 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:47:49.712759 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m15:47:49.715301 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.715539 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122154749676093"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122154749676093"
    )
  
[0m15:47:49.716787 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m15:47:49.721423 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m15:47:49.721625 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m15:47:49.721795 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m15:47:49.722056 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m15:47:49.722991 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m15:47:49.725548 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96bc2477-235d-4d7d-bd55-16e52551de7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d33a0>]}
[0m15:47:49.725870 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m15:47:49.726140 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m15:47:49.726633 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:49.726805 [debug] [MainThread]: On master: BEGIN
[0m15:47:49.726946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:49.727190 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:47:49.727330 [debug] [MainThread]: On master: COMMIT
[0m15:47:49.727467 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:49.727599 [debug] [MainThread]: On master: COMMIT
[0m15:47:49.727777 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:47:49.727913 [debug] [MainThread]: On master: Close
[0m15:47:49.728088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:49.728222 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m15:47:49.728366 [info ] [MainThread]: 
[0m15:47:49.728520 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m15:47:49.728820 [debug] [MainThread]: Command end result
[0m15:47:49.744821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m15:47:49.746455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m15:47:49.753509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m15:47:49.753739 [info ] [MainThread]: 
[0m15:47:49.753952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:49.754104 [info ] [MainThread]: 
[0m15:47:49.754264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:47:49.775450 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8332377, "process_in_blocks": "0", "process_kernel_time": 0.226411, "process_mem_max_rss": "145637376", "process_out_blocks": "0", "process_user_time": 1.181835}
[0m15:47:49.775768 [debug] [MainThread]: Command `dbt build` succeeded at 15:47:49.775718 after 0.83 seconds
[0m15:47:49.775981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ba460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc577f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1249a0>]}
[0m15:47:49.776185 [debug] [MainThread]: Flushing usage events
[0m15:47:50.751581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:18.442505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093544c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093542e0>]}


============================== 16:00:18.445296 | 1958fc82-acf2-47da-a130-f1f2075b2f6a ==============================
[0m16:00:18.445296 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:00:18.445597 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/davidhe/data-lab-new/logs', 'static_parser': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'empty': 'False', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True'}
[0m16:00:18.632045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944adc0>]}
[0m16:00:18.659971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109323e50>]}
[0m16:00:18.662413 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:00:18.722402 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:00:18.800912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:18.801169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:18.804536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m16:00:18.817204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109929130>]}
[0m16:00:18.861673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m16:00:18.868594 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m16:00:18.898995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109953b50>]}
[0m16:00:18.899324 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:00:18.899502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109794220>]}
[0m16:00:18.900126 [info ] [MainThread]: 
[0m16:00:18.900319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:18.900460 [info ] [MainThread]: 
[0m16:00:18.900712 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:00:18.901156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:00:19.012366 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:00:19.012626 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:00:19.012786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:19.026996 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:00:19.027825 [debug] [ThreadPool]: On list_lab: Close
[0m16:00:19.028174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m16:00:19.028400 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m16:00:19.031834 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:00:19.032007 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:00:19.032149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:19.032560 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:00:19.033115 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:00:19.033264 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m16:00:19.033462 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:00:19.033601 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:00:19.033742 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m16:00:19.034153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:00:19.034572 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m16:00:19.034732 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:00:19.034870 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m16:00:19.035068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:00:19.035210 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m16:00:19.035677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m16:00:19.038376 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m16:00:19.038537 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m16:00:19.038699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:19.038977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:00:19.039173 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m16:00:19.039332 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m16:00:19.045298 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:00:19.046073 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m16:00:19.047345 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m16:00:19.047509 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m16:00:19.047887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109953c10>]}
[0m16:00:19.048119 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:19.048262 [debug] [MainThread]: On master: BEGIN
[0m16:00:19.048398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:19.048617 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:00:19.048755 [debug] [MainThread]: On master: COMMIT
[0m16:00:19.048892 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:19.049026 [debug] [MainThread]: On master: COMMIT
[0m16:00:19.049249 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:00:19.049415 [debug] [MainThread]: On master: Close
[0m16:00:19.051017 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:00:19.051273 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m16:00:19.051581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m16:00:19.051760 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:00:19.058965 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:00:19.062491 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:00:19.090559 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.090868 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122160019080524"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from lab.bronze.orders

    
        where order_date > (
            select max(t.most_recent_order_date)
            from "lab"."main_silver"."silver_transform" as t
        )
    

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '1958fc82-acf2-47da-a130-f1f2075b2f6a' as _dbt_invocation_id
    from customers as c
    left join customer_orders as co
        on c.customer_id = co.customer_id

)

select *
from final


    where customer_id in (
        select co.customer_id
        from customer_orders as co
    )

    );
  
  
  
[0m16:00:19.091075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:00:19.098830 [debug] [Thread-1  ]: SQL status: OK in 0.008 seconds
[0m16:00:19.102518 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.102730 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:00:19.102996 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:00:19.103163 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.103328 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122160019080524'
      
      
      order by ordinal_position

  
[0m16:00:19.104828 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:00:19.107742 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.107951 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m16:00:19.108901 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:00:19.112544 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.112773 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m16:00:19.113734 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:00:19.114405 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.114574 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m16:00:19.114823 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:00:19.121773 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:00:19.127822 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.128023 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122160019080524"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122160019080524"
    )
  
[0m16:00:19.129715 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m16:00:19.134126 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:00:19.134315 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:00:19.134473 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:00:19.134724 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:00:19.135630 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:00:19.136982 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1958fc82-acf2-47da-a130-f1f2075b2f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c72130>]}
[0m16:00:19.137298 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m16:00:19.137559 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:00:19.138056 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:19.138215 [debug] [MainThread]: On master: BEGIN
[0m16:00:19.138354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:19.138673 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:00:19.138825 [debug] [MainThread]: On master: COMMIT
[0m16:00:19.138992 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:19.139159 [debug] [MainThread]: On master: COMMIT
[0m16:00:19.139371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:00:19.139528 [debug] [MainThread]: On master: Close
[0m16:00:19.139728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:19.139866 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m16:00:19.140024 [info ] [MainThread]: 
[0m16:00:19.140187 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m16:00:19.140495 [debug] [MainThread]: Command end result
[0m16:00:19.157839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m16:00:19.160229 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m16:00:19.168772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m16:00:19.168966 [info ] [MainThread]: 
[0m16:00:19.169173 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:19.169326 [info ] [MainThread]: 
[0m16:00:19.169490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:00:19.171171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8146649, "process_in_blocks": "0", "process_kernel_time": 0.228877, "process_mem_max_rss": "144490496", "process_out_blocks": "0", "process_user_time": 1.027603}
[0m16:00:19.171380 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:19.171342 after 0.81 seconds
[0m16:00:19.171570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109953be0>]}
[0m16:00:19.171758 [debug] [MainThread]: Flushing usage events
[0m16:00:20.241313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:34.479736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10addd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10addd280>]}


============================== 16:09:34.482715 | 1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f ==============================
[0m16:09:34.482715 [info ] [MainThread]: Running with dbt=1.10.18
[0m16:09:34.483021 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_path': '/Users/davidhe/data-lab-new/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False'}
[0m16:09:34.675759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861d3a0>]}
[0m16:09:34.703951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad7e4f0>]}
[0m16:09:34.706052 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:09:34.766885 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m16:09:34.848355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:34.848610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:34.852148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m16:09:34.864595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39b130>]}
[0m16:09:34.908720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m16:09:34.915864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m16:09:34.937758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c67c0>]}
[0m16:09:34.938088 [info ] [MainThread]: Found 1 model, 456 macros
[0m16:09:34.938271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b369040>]}
[0m16:09:34.938904 [info ] [MainThread]: 
[0m16:09:34.939085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:34.939228 [info ] [MainThread]: 
[0m16:09:34.939480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:09:34.939949 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m16:09:35.051063 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m16:09:35.051313 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m16:09:35.051468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:35.063533 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:09:35.064293 [debug] [ThreadPool]: On list_lab: Close
[0m16:09:35.064668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m16:09:35.064936 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m16:09:35.068333 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:09:35.068522 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m16:09:35.068665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:35.069232 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:09:35.069861 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:09:35.070021 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m16:09:35.070250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:09:35.070391 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:09:35.070530 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m16:09:35.070771 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:09:35.071127 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m16:09:35.071274 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m16:09:35.071408 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m16:09:35.071593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:09:35.071734 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m16:09:35.072220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m16:09:35.074865 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m16:09:35.075028 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m16:09:35.075163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:35.075392 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:09:35.075530 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m16:09:35.075675 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m16:09:35.081041 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:09:35.081946 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m16:09:35.083261 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m16:09:35.083430 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m16:09:35.083833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3a7760>]}
[0m16:09:35.084084 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:35.084229 [debug] [MainThread]: On master: BEGIN
[0m16:09:35.084365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:35.084612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:09:35.084752 [debug] [MainThread]: On master: COMMIT
[0m16:09:35.084889 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:35.085024 [debug] [MainThread]: On master: COMMIT
[0m16:09:35.085239 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:09:35.085411 [debug] [MainThread]: On master: Close
[0m16:09:35.087257 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m16:09:35.087538 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m16:09:35.087858 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m16:09:35.088043 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m16:09:35.095011 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m16:09:35.098347 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m16:09:35.127660 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.127950 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122160935116777"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from lab.bronze.orders

    
        where order_date > (
            select max(t.most_recent_order_date)
            from "lab"."main_silver"."silver_transform" as t
        )
    

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f' as _dbt_invocation_id
    from customers as c
    left join customer_orders as co
        on c.customer_id = co.customer_id

)

select *
from final


    where customer_id in (
        select co.customer_id
        from customer_orders as co
    )

    );
  
  
  
[0m16:09:35.128149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:35.134487 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m16:09:35.138467 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.138720 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m16:09:35.139017 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:09:35.139186 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.139358 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122160935116777'
      
      
      order by ordinal_position

  
[0m16:09:35.140998 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:09:35.143701 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.143902 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m16:09:35.144874 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:09:35.148595 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.148801 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m16:09:35.149729 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:09:35.150434 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.150607 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m16:09:35.150854 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:09:35.158175 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m16:09:35.163644 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.163853 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122160935116777"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122160935116777"
    )
  
[0m16:09:35.165131 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:09:35.169719 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:09:35.169950 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m16:09:35.170116 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m16:09:35.170401 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:09:35.171338 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m16:09:35.172651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce41a54-5ba7-4a7a-b6ae-e9c6f07b823f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e6730>]}
[0m16:09:35.172988 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m16:09:35.173258 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m16:09:35.173773 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:35.173931 [debug] [MainThread]: On master: BEGIN
[0m16:09:35.174069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:35.174315 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:09:35.174457 [debug] [MainThread]: On master: COMMIT
[0m16:09:35.174592 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:35.174723 [debug] [MainThread]: On master: COMMIT
[0m16:09:35.174922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:09:35.175076 [debug] [MainThread]: On master: Close
[0m16:09:35.175261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:35.175395 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m16:09:35.175540 [info ] [MainThread]: 
[0m16:09:35.175699 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m16:09:35.176003 [debug] [MainThread]: Command end result
[0m16:09:35.192674 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m16:09:35.194900 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m16:09:35.203415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m16:09:35.203622 [info ] [MainThread]: 
[0m16:09:35.203829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:35.203980 [info ] [MainThread]: 
[0m16:09:35.204145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:09:35.205733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8030671, "process_in_blocks": "0", "process_kernel_time": 0.240025, "process_mem_max_rss": "144211968", "process_out_blocks": "0", "process_user_time": 1.036321}
[0m16:09:35.205946 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:35.205909 after 0.80 seconds
[0m16:09:35.206134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad7e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b38e160>]}
[0m16:09:35.206319 [debug] [MainThread]: Flushing usage events
[0m16:09:36.323767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:49.273293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fa460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b27d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b27d2e0>]}


============================== 17:11:49.279074 | 817fbd84-fee3-4c47-9ee5-cb19a84b13ef ==============================
[0m17:11:49.279074 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:11:49.279390 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m17:11:49.678138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36fdc0>]}
[0m17:11:49.710170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24de50>]}
[0m17:11:49.719194 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:49.822849 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:11:50.078775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:50.079033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:50.082478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:11:50.095952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83b130>]}
[0m17:11:50.133631 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:11:50.139539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:11:50.192393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b866b50>]}
[0m17:11:50.192726 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:11:50.192910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a7220>]}
[0m17:11:50.193545 [info ] [MainThread]: 
[0m17:11:50.193728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:50.193874 [info ] [MainThread]: 
[0m17:11:50.194125 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:50.194595 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:11:50.890637 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:11:50.891274 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:11:50.891663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:50.907191 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m17:11:50.908015 [debug] [ThreadPool]: On list_lab: Close
[0m17:11:50.908415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:11:50.908655 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:11:50.912400 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:11:50.912837 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:11:50.913051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:50.913658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:50.914993 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:11:50.915338 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:11:50.915792 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:50.915985 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:11:50.916139 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:11:50.916468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:50.916943 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:11:50.917192 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:11:50.917357 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:11:50.917604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:50.917767 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:11:50.918391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:11:50.922297 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:11:50.922570 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:11:50.922730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:50.923060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:50.923212 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:11:50.923360 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:11:50.927773 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:11:50.928448 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:11:50.934228 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:11:50.934468 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:11:50.934929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b866c10>]}
[0m17:11:50.935189 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:50.935341 [debug] [MainThread]: On master: BEGIN
[0m17:11:50.935477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:50.935778 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:50.935929 [debug] [MainThread]: On master: COMMIT
[0m17:11:50.936066 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:50.936205 [debug] [MainThread]: On master: COMMIT
[0m17:11:50.936404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:50.936548 [debug] [MainThread]: On master: Close
[0m17:11:50.942876 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:11:50.943269 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:11:50.943881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:11:50.944135 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:11:50.951685 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:11:50.955641 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:11:50.987403 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:50.987702 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122171150976459"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from lab.bronze.orders

    
        where order_date > (
            select max(t.most_recent_order_date)
            from "lab"."main_silver"."silver_transform" as t
        )
    

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders
    group by customer_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '817fbd84-fee3-4c47-9ee5-cb19a84b13ef' as _dbt_invocation_id
    from customers as c
    left join customer_orders as co
        on c.customer_id = co.customer_id

)

select *
from final


    where customer_id in (
        select co.customer_id
        from customer_orders as co
    )

    );
  
  
  
[0m17:11:50.987906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:50.992068 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m17:11:50.995929 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:50.996177 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:11:50.996490 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:11:50.996667 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:50.996841 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122171150976459'
      
      
      order by ordinal_position

  
[0m17:11:50.998099 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:11:51.000782 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:51.000991 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:11:51.001943 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:11:51.005837 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:51.006076 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:11:51.007097 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:11:51.007837 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:51.008015 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:11:51.008278 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:11:51.015694 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:11:51.018249 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:51.018457 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122171150976459"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122171150976459"
    )
  
[0m17:11:51.019631 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:11:51.024601 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:11:51.024812 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:11:51.024974 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:11:51.025239 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:11:51.026165 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:11:51.028770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817fbd84-fee3-4c47-9ee5-cb19a84b13ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb86130>]}
[0m17:11:51.029128 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m17:11:51.029403 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:11:51.029930 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:51.030112 [debug] [MainThread]: On master: BEGIN
[0m17:11:51.030257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:51.030536 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:51.030683 [debug] [MainThread]: On master: COMMIT
[0m17:11:51.030825 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:51.030958 [debug] [MainThread]: On master: COMMIT
[0m17:11:51.031158 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:51.031303 [debug] [MainThread]: On master: Close
[0m17:11:51.031485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:51.031620 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:11:51.031776 [info ] [MainThread]: 
[0m17:11:51.031937 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m17:11:51.032251 [debug] [MainThread]: Command end result
[0m17:11:51.046505 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:11:51.048995 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:11:51.055294 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:11:51.055592 [info ] [MainThread]: 
[0m17:11:51.055810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:51.055967 [info ] [MainThread]: 
[0m17:11:51.056139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:11:51.062513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9067165, "process_in_blocks": "0", "process_kernel_time": 0.497234, "process_mem_max_rss": "144637952", "process_out_blocks": "0", "process_user_time": 1.742256}
[0m17:11:51.062813 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:51.062764 after 1.91 seconds
[0m17:11:51.063034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fa460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b866be0>]}
[0m17:11:51.063257 [debug] [MainThread]: Flushing usage events
[0m17:11:52.205403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:43.694216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef52e0>]}


============================== 17:38:43.697150 | ea7ce636-11b8-4c4d-9a8f-ea948ac11db1 ==============================
[0m17:38:43.697150 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:38:43.697534 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'log_path': '/Users/davidhe/data-lab-new/logs', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m17:38:43.868800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcd3d0>]}
[0m17:38:43.897062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c52e0>]}
[0m17:38:43.898622 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:38:43.986596 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:38:44.061136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:44.061395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:44.064859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:38:44.078506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b5130>]}
[0m17:38:44.121753 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:38:44.135964 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:38:44.186880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094dfca0>]}
[0m17:38:44.187198 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:38:44.187371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e0400>]}
[0m17:38:44.187992 [info ] [MainThread]: 
[0m17:38:44.188174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:44.188318 [info ] [MainThread]: 
[0m17:38:44.188570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:44.189025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:38:44.303077 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:38:44.303333 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:38:44.303490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:44.309385 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:38:44.310065 [debug] [ThreadPool]: On list_lab: Close
[0m17:38:44.310418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:38:44.310651 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:38:44.314059 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:44.314249 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:38:44.314405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:44.314919 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:38:44.315552 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:44.315716 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:38:44.315929 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:44.316070 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:44.316209 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:38:44.316439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:44.316793 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:38:44.316940 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:38:44.317074 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:38:44.317288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:44.317429 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:38:44.317914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:38:44.320565 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:38:44.320720 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:38:44.320857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:44.321099 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:44.321240 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:38:44.321390 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:38:44.325932 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:38:44.326550 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:38:44.327609 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:38:44.327764 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:38:44.328150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094879a0>]}
[0m17:38:44.328381 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:44.328525 [debug] [MainThread]: On master: BEGIN
[0m17:38:44.328656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:44.328871 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:44.329010 [debug] [MainThread]: On master: COMMIT
[0m17:38:44.329143 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:44.329277 [debug] [MainThread]: On master: COMMIT
[0m17:38:44.329473 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:44.329628 [debug] [MainThread]: On master: Close
[0m17:38:44.330872 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:38:44.331157 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:38:44.331495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:38:44.331683 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:38:44.338733 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:38:44.343203 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:38:44.371531 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.371844 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122173844361538"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

)

select * from final
    );
  
  
  
[0m17:38:44.372046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:38:44.380373 [debug] [Thread-1  ]: SQL status: OK in 0.008 seconds
[0m17:38:44.384255 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.384473 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:38:44.384750 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:38:44.384914 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.385080 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122173844361538'
      
      
      order by ordinal_position

  
[0m17:38:44.386694 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:44.389522 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.389741 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:38:44.390866 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:44.394529 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.394731 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:38:44.395623 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:44.396296 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.396467 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:38:44.396705 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:38:44.403823 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:38:44.409175 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.409395 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122173844361538"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122173844361538"
    )
  
[0m17:38:44.410900 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:44.415408 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:38:44.415608 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:38:44.415768 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:38:44.416696 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:38:44.417689 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:38:44.423356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea7ce636-11b8-4c4d-9a8f-ea948ac11db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fd5b0>]}
[0m17:38:44.423729 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m17:38:44.424010 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:38:44.424769 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:44.424943 [debug] [MainThread]: On master: BEGIN
[0m17:38:44.425083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:44.425361 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:44.425500 [debug] [MainThread]: On master: COMMIT
[0m17:38:44.425635 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:44.425766 [debug] [MainThread]: On master: COMMIT
[0m17:38:44.425994 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:44.426168 [debug] [MainThread]: On master: Close
[0m17:38:44.426363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:44.426499 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:38:44.426651 [info ] [MainThread]: 
[0m17:38:44.426813 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m17:38:44.427118 [debug] [MainThread]: Command end result
[0m17:38:44.447044 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:38:44.449837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:38:44.460492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:38:44.460719 [info ] [MainThread]: 
[0m17:38:44.460932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:44.461091 [info ] [MainThread]: 
[0m17:38:44.461252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:38:44.475912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8900699, "process_in_blocks": "0", "process_kernel_time": 0.235155, "process_mem_max_rss": "153829376", "process_out_blocks": "0", "process_user_time": 1.122809}
[0m17:38:44.476247 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:44.476202 after 0.89 seconds
[0m17:38:44.476455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106735790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094dfc10>]}
[0m17:38:44.476669 [debug] [MainThread]: Flushing usage events
[0m17:38:45.523232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:04.195795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090594c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090592e0>]}


============================== 17:42:04.198245 | ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5 ==============================
[0m17:42:04.198245 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:42:04.198569 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'empty': 'False', 'log_path': '/Users/davidhe/data-lab-new/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True'}
[0m17:42:04.326579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e91340>]}
[0m17:42:04.355122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901e910>]}
[0m17:42:04.356906 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:42:04.415938 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:42:04.491454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:04.491721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:04.495234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:42:04.508548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109619130>]}
[0m17:42:04.552276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:42:04.555135 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:42:04.580484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109643bb0>]}
[0m17:42:04.580808 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:42:04.580995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e8eb0>]}
[0m17:42:04.581675 [info ] [MainThread]: 
[0m17:42:04.581901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:04.582053 [info ] [MainThread]: 
[0m17:42:04.582319 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:42:04.582783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:42:04.693485 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:42:04.693747 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:42:04.693905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:04.699798 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:42:04.700471 [debug] [ThreadPool]: On list_lab: Close
[0m17:42:04.700848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:42:04.701114 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:42:04.704779 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:42:04.704987 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:42:04.705137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:04.705570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:04.706145 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:42:04.706295 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:42:04.706547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:04.706713 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:42:04.706859 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:42:04.707114 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:04.707532 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:42:04.707693 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:42:04.707830 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:42:04.708031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:04.708178 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:42:04.708709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:42:04.711612 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:42:04.711798 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:42:04.711940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:04.712199 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:04.712340 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:42:04.712483 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:42:04.716973 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:42:04.717583 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:42:04.718869 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:42:04.719053 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:42:04.719359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108291a30>]}
[0m17:42:04.719604 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:04.719753 [debug] [MainThread]: On master: BEGIN
[0m17:42:04.719891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:04.720153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:04.720296 [debug] [MainThread]: On master: COMMIT
[0m17:42:04.720434 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:04.720573 [debug] [MainThread]: On master: COMMIT
[0m17:42:04.720771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:04.720915 [debug] [MainThread]: On master: Close
[0m17:42:04.722215 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:42:04.722506 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:42:04.722753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:42:04.722930 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:42:04.728889 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:42:04.732183 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:42:04.762870 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:42:04.765410 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:42:04.765637 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:42:04.765810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:42:04.766164 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:42:04.766337 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:42:04.766518 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
    
    

    create  table
      "lab"."main_silver"."silver_transform"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

)

select * from final
    );
  
  
  
[0m17:42:04.769127 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:42:04.775665 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:42:04.775908 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:42:04.776088 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:42:04.776874 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:42:04.777883 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:42:04.779026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec7c8ec6-10da-45ca-89ad-b3fc6ca3aca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f5f40>]}
[0m17:42:04.779374 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.06s]
[0m17:42:04.779654 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:42:04.780246 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:04.780414 [debug] [MainThread]: On master: BEGIN
[0m17:42:04.780555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:04.780818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:04.780960 [debug] [MainThread]: On master: COMMIT
[0m17:42:04.781095 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:04.781233 [debug] [MainThread]: On master: COMMIT
[0m17:42:04.781429 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:04.781575 [debug] [MainThread]: On master: Close
[0m17:42:04.781771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:04.781907 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:42:04.782061 [info ] [MainThread]: 
[0m17:42:04.782223 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m17:42:04.782538 [debug] [MainThread]: Command end result
[0m17:42:04.799013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:42:04.801191 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:42:04.809787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:42:04.810007 [info ] [MainThread]: 
[0m17:42:04.810214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:04.810371 [info ] [MainThread]: 
[0m17:42:04.810535 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:42:04.812006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6929924, "process_in_blocks": "0", "process_kernel_time": 0.218271, "process_mem_max_rss": "150880256", "process_out_blocks": "0", "process_user_time": 1.039593}
[0m17:42:04.812235 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:04.812194 after 0.69 seconds
[0m17:42:04.812433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109643be0>]}
[0m17:42:04.812629 [debug] [MainThread]: Flushing usage events
[0m17:42:05.920776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:58.410711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098444c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098442e0>]}


============================== 17:43:58.413617 | 109a5e2b-4902-40a3-a7f6-a0792be08225 ==============================
[0m17:43:58.413617 [info ] [MainThread]: Running with dbt=1.10.18
[0m17:43:58.414012 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'log_path': '/Users/davidhe/data-lab-new/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'invocation_command': 'dbt run', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80'}
[0m17:43:58.569684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991c3d0>]}
[0m17:43:58.599590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091152e0>]}
[0m17:43:58.601234 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:43:58.667041 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m17:43:58.747974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:58.748247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:58.751790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m17:43:58.765373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e05130>]}
[0m17:43:58.821355 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:43:58.824256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:43:58.844934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2fca0>]}
[0m17:43:58.845252 [info ] [MainThread]: Found 1 model, 456 macros
[0m17:43:58.845429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a31400>]}
[0m17:43:58.846051 [info ] [MainThread]: 
[0m17:43:58.846232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:58.846374 [info ] [MainThread]: 
[0m17:43:58.846629 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:43:58.847113 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m17:43:58.952485 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m17:43:58.952737 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m17:43:58.952890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:58.958857 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:43:58.959519 [debug] [ThreadPool]: On list_lab: Close
[0m17:43:58.959887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m17:43:58.960121 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m17:43:58.963599 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:43:58.963803 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m17:43:58.963949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:58.964388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:58.964963 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:43:58.965114 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m17:43:58.965330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:58.965466 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:43:58.965601 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m17:43:58.965820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:58.966171 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:43:58.966316 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m17:43:58.966451 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m17:43:58.966630 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:58.966770 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m17:43:58.967258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m17:43:58.969948 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:43:58.970103 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m17:43:58.970237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:58.970440 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:58.970574 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m17:43:58.970714 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m17:43:58.975017 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:43:58.975647 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m17:43:58.976687 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m17:43:58.976842 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m17:43:58.977215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd79a0>]}
[0m17:43:58.977449 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:58.977595 [debug] [MainThread]: On master: BEGIN
[0m17:43:58.977731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:58.977989 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:58.978131 [debug] [MainThread]: On master: COMMIT
[0m17:43:58.978268 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:58.978408 [debug] [MainThread]: On master: COMMIT
[0m17:43:58.978598 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:58.978744 [debug] [MainThread]: On master: Close
[0m17:43:58.980009 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m17:43:58.980281 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m17:43:58.980588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m17:43:58.980764 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m17:43:58.987584 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m17:43:58.990624 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m17:43:59.019744 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.020040 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122174359009615"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '109a5e2b-4902-40a3-a7f6-a0792be08225' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

)

select * from final
    );
  
  
  
[0m17:43:59.020237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:59.021944 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:43:59.025709 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.025932 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m17:43:59.026215 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:43:59.026379 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.026545 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122174359009615'
      
      
      order by ordinal_position

  
[0m17:43:59.027502 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:43:59.029866 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.030096 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:43:59.031081 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:43:59.034735 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.034957 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m17:43:59.035910 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:43:59.036610 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.036783 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m17:43:59.037027 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:43:59.044629 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m17:43:59.050537 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.050753 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122174359009615"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122174359009615"
    )
  
[0m17:43:59.051523 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:43:59.056137 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:43:59.056352 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m17:43:59.056520 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m17:43:59.056794 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:43:59.057844 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m17:43:59.059062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '109a5e2b-4902-40a3-a7f6-a0792be08225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14f5b0>]}
[0m17:43:59.059391 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m17:43:59.059660 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m17:43:59.060151 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:59.060303 [debug] [MainThread]: On master: BEGIN
[0m17:43:59.060440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:59.060676 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:59.060814 [debug] [MainThread]: On master: COMMIT
[0m17:43:59.060951 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:59.061085 [debug] [MainThread]: On master: COMMIT
[0m17:43:59.061292 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:59.061431 [debug] [MainThread]: On master: Close
[0m17:43:59.061602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:59.061735 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m17:43:59.061884 [info ] [MainThread]: 
[0m17:43:59.062039 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m17:43:59.062338 [debug] [MainThread]: Command end result
[0m17:43:59.079012 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m17:43:59.081148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m17:43:59.090194 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m17:43:59.090384 [info ] [MainThread]: 
[0m17:43:59.090595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:59.090750 [info ] [MainThread]: 
[0m17:43:59.090928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:43:59.092594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7216831, "process_in_blocks": "0", "process_kernel_time": 0.219405, "process_mem_max_rss": "144244736", "process_out_blocks": "0", "process_user_time": 1.088611}
[0m17:43:59.092809 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:59.092769 after 0.72 seconds
[0m17:43:59.093009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2fc70>]}
[0m17:43:59.093215 [debug] [MainThread]: Flushing usage events
[0m17:43:59.978276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:39.137000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb3e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbc0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbc0280>]}


============================== 18:01:39.152160 | 0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27 ==============================
[0m18:01:39.152160 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:01:39.152828 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/davidhe/data-lab-new', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False'}
[0m18:01:39.279440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4013a0>]}
[0m18:01:39.303704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb624f0>]}
[0m18:01:39.304932 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:01:39.359721 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:01:39.428596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:39.428796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:39.431784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:01:39.442724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d195130>]}
[0m18:01:39.485795 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:01:39.494102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:01:39.522680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bf7c0>]}
[0m18:01:39.522961 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:01:39.523143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d162040>]}
[0m18:01:39.523731 [info ] [MainThread]: 
[0m18:01:39.523917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:39.524070 [info ] [MainThread]: 
[0m18:01:39.524328 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:39.524774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:01:39.626768 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:01:39.626997 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:01:39.627136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:39.632340 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:01:39.632885 [debug] [ThreadPool]: On list_lab: Close
[0m18:01:39.633189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:01:39.633396 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:01:39.636373 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:01:39.636520 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:01:39.636651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:39.636991 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:39.637508 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:01:39.637654 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:01:39.637852 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:39.637991 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:01:39.638118 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:01:39.638322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:39.638643 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:01:39.638775 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:01:39.638897 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:01:39.639076 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:39.639211 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:01:39.639710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:01:39.642211 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:01:39.642356 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:01:39.642478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:39.642674 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:39.642795 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:01:39.642921 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:01:39.646645 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:01:39.647127 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:01:39.648014 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:01:39.648160 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:01:39.648469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1a0760>]}
[0m18:01:39.648669 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:39.648800 [debug] [MainThread]: On master: BEGIN
[0m18:01:39.648922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:39.649130 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:39.649282 [debug] [MainThread]: On master: COMMIT
[0m18:01:39.649412 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:39.649552 [debug] [MainThread]: On master: COMMIT
[0m18:01:39.649769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:39.649942 [debug] [MainThread]: On master: Close
[0m18:01:39.650983 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:01:39.651196 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:01:39.651475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:01:39.651629 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:01:39.657782 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:01:39.661292 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:01:39.686560 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.686809 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122180139677330"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        where c.customer_id in (
            select c.customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:01:39.686988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:39.689159 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:01:39.692329 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.692500 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:01:39.692725 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:01:39.692889 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.693058 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122180139677330'
      
      
      order by ordinal_position

  
[0m18:01:39.693925 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:01:39.696120 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.696302 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:01:39.697133 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:01:39.700281 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.700448 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:01:39.701216 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:01:39.701821 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.701973 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:01:39.702194 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:01:39.708563 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:01:39.710929 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.711099 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122180139677330"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122180139677330"
    )
  
[0m18:01:39.711714 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:01:39.715830 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:01:39.716003 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:01:39.716152 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:01:39.716376 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:01:39.717212 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:01:39.718468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0498eb29-a5c5-4af0-b7c6-d5ad7e6cee27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4de730>]}
[0m18:01:39.718752 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.07s]
[0m18:01:39.719012 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:01:39.719468 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:39.719617 [debug] [MainThread]: On master: BEGIN
[0m18:01:39.719746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:39.719952 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:39.720090 [debug] [MainThread]: On master: COMMIT
[0m18:01:39.720224 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:39.720344 [debug] [MainThread]: On master: COMMIT
[0m18:01:39.720525 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:39.720685 [debug] [MainThread]: On master: Close
[0m18:01:39.720858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:39.720981 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:01:39.721112 [info ] [MainThread]: 
[0m18:01:39.721263 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:01:39.721555 [debug] [MainThread]: Command end result
[0m18:01:39.738043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:01:39.740531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:01:39.750413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:01:39.750601 [info ] [MainThread]: 
[0m18:01:39.750807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:39.750957 [info ] [MainThread]: 
[0m18:01:39.751115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:01:39.752560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.65208983, "process_in_blocks": "0", "process_kernel_time": 0.18791, "process_mem_max_rss": "144637952", "process_out_blocks": "0", "process_user_time": 0.920883}
[0m18:01:39.752741 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:39.752708 after 0.65 seconds
[0m18:01:39.752910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb3e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb624f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d188ee0>]}
[0m18:01:39.753075 [debug] [MainThread]: Flushing usage events
[0m18:01:40.968769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:57.785718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097594f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109759310>]}


============================== 18:02:57.791844 | 25936243-de54-4c63-b452-8154b0871139 ==============================
[0m18:02:57.791844 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:02:57.792372 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_path': '/Users/davidhe/data-lab-new/logs', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False'}
[0m18:02:58.159477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f2370>]}
[0m18:02:58.184482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109899ee0>]}
[0m18:02:58.192017 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:02:58.304575 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:02:58.567845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:58.568308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:58.575391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:02:58.594830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d18130>]}
[0m18:02:58.635528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:02:58.641088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:02:58.692808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d42190>]}
[0m18:02:58.693160 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:02:58.693379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce2be0>]}
[0m18:02:58.694101 [info ] [MainThread]: 
[0m18:02:58.694322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:58.694502 [info ] [MainThread]: 
[0m18:02:58.694801 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:58.695354 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:02:59.265015 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:02:59.265876 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:02:59.266296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:59.283387 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:02:59.284786 [debug] [ThreadPool]: On list_lab: Close
[0m18:02:59.285522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:02:59.286072 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:02:59.292641 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:02:59.292967 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:02:59.293242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:59.293921 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:02:59.294961 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:02:59.295240 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:02:59.295581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:59.295809 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:02:59.296042 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:02:59.296446 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:59.297186 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:02:59.297481 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:02:59.297741 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:02:59.298105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:59.298379 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:02:59.299121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:02:59.303172 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:02:59.303398 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:02:59.303601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:59.303891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:59.304092 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:02:59.304302 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:02:59.310077 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:02:59.310903 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:02:59.317221 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:02:59.317446 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:02:59.317941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096900a0>]}
[0m18:02:59.318264 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:59.318469 [debug] [MainThread]: On master: BEGIN
[0m18:02:59.318656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:59.318970 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:59.319162 [debug] [MainThread]: On master: COMMIT
[0m18:02:59.319351 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:59.319541 [debug] [MainThread]: On master: COMMIT
[0m18:02:59.319801 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:59.319994 [debug] [MainThread]: On master: Close
[0m18:02:59.324701 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:02:59.325040 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:02:59.325426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:02:59.325668 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:02:59.334769 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:02:59.338963 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:02:59.369369 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.369666 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122180259359249"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '25936243-de54-4c63-b452-8154b0871139' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        where c.customer_id in (
            select c.customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:02:59.369872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:02:59.371794 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:02:59.375228 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.375408 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:02:59.375646 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:02:59.375802 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.375962 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122180259359249'
      
      
      order by ordinal_position

  
[0m18:02:59.376899 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:02:59.379086 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.379259 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:02:59.380117 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:02:59.383540 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.383758 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:02:59.384548 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:02:59.385151 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.385302 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:02:59.385613 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:02:59.392094 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:02:59.398072 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.398248 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

        
            delete from "lab"."main_silver"."silver_transform"
            where (
                customer_id) in (
                select (customer_id)
                from "silver_transform__dbt_tmp20260122180259359249"
            );

        
    

    insert into "lab"."main_silver"."silver_transform" ("customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id")
    (
        select "customer_id", "first_name", "last_name", "first_order_date", "most_recent_order_date", "number_of_orders", "_dbt_loaded_at", "_dbt_invocation_id"
        from "silver_transform__dbt_tmp20260122180259359249"
    )
  
[0m18:02:59.398898 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:02:59.402985 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:02:59.403141 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:02:59.403282 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:02:59.403486 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:02:59.404354 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:02:59.410362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25936243-de54-4c63-b452-8154b0871139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a061070>]}
[0m18:02:59.410666 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.08s]
[0m18:02:59.410932 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:02:59.411387 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:59.411542 [debug] [MainThread]: On master: BEGIN
[0m18:02:59.411672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:59.411892 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:59.412022 [debug] [MainThread]: On master: COMMIT
[0m18:02:59.412145 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:59.412269 [debug] [MainThread]: On master: COMMIT
[0m18:02:59.412461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:59.412608 [debug] [MainThread]: On master: Close
[0m18:02:59.412776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:59.412897 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:02:59.413033 [info ] [MainThread]: 
[0m18:02:59.413197 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m18:02:59.413503 [debug] [MainThread]: Command end result
[0m18:02:59.430347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:02:59.432878 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:02:59.443573 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:02:59.443734 [info ] [MainThread]: 
[0m18:02:59.443943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:59.444093 [info ] [MainThread]: 
[0m18:02:59.444248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:02:59.457587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8259757, "process_in_blocks": "0", "process_kernel_time": 0.505601, "process_mem_max_rss": "144982016", "process_out_blocks": "0", "process_user_time": 1.860355}
[0m18:02:59.457838 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:59.457798 after 1.83 seconds
[0m18:02:59.458026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a2b0>]}
[0m18:02:59.458211 [debug] [MainThread]: Flushing usage events
[0m18:03:00.429714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:51.674798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c28a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d30c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d30c370>]}


============================== 18:08:51.677374 | 6711b436-e95b-43da-83b7-3aad1db9ccc6 ==============================
[0m18:08:51.677374 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:08:51.677651 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:08:51.795582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d0670>]}
[0m18:08:51.820019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d5f40>]}
[0m18:08:51.821418 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:08:51.874379 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:08:51.946527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:51.946754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:51.949780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:08:51.960355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cd130>]}
[0m18:08:52.002064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:08:52.009808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:08:52.027793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a15e0>]}
[0m18:08:52.028041 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:08:52.028211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d897e80>]}
[0m18:08:52.028748 [info ] [MainThread]: 
[0m18:08:52.028928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:52.029067 [info ] [MainThread]: 
[0m18:08:52.029311 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:52.029742 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:08:52.127673 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:08:52.127911 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:08:52.128053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:52.133281 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:08:52.133818 [debug] [ThreadPool]: On list_lab: Close
[0m18:08:52.134124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:08:52.134337 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:08:52.137229 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:08:52.137376 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:08:52.137499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:52.137817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:52.138350 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:08:52.138505 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:08:52.138705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:52.138834 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:08:52.138961 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:08:52.139163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:52.139482 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:08:52.139618 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:08:52.139740 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:08:52.139921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:52.140051 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:08:52.140444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:08:52.142818 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:08:52.142963 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:08:52.143084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:52.143284 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:52.143408 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:08:52.143535 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:08:52.147228 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:08:52.147729 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:08:52.148575 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:08:52.148715 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:08:52.149032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f7be0>]}
[0m18:08:52.149233 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:52.149361 [debug] [MainThread]: On master: BEGIN
[0m18:08:52.149484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:52.149678 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:52.149804 [debug] [MainThread]: On master: COMMIT
[0m18:08:52.149927 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:52.150048 [debug] [MainThread]: On master: COMMIT
[0m18:08:52.150242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:52.150397 [debug] [MainThread]: On master: Close
[0m18:08:52.151418 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:08:52.151635 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:08:52.151924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:08:52.152083 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:08:52.158100 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:08:52.161961 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:08:52.187474 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:08:52.187731 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122180852178266"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

with changed_customers as (
    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select coalesce(max(most_recent_order_date), '1900-01-01')
            from "lab"."main_silver"."silver_transform"
        )
    
),

customer_orders as (
    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
)

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '6711b436-e95b-43da-83b7-3aad1db9ccc6' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        where c.customer_id in (
            select c.customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:08:52.187909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:52.188454 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122180852178266"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

with changed_customers as (
    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select coalesce(max(most_recent_order_date), '1900-01-01')
            from "lab"."main_silver"."silver_transform"
        )
    
),

customer_orders as (
    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
)

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '6711b436-e95b-43da-83b7-3aad1db9ccc6' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        where c.customer_id in (
            select c.customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:08:52.188726 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m18:08:52.188947 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:08:52.250342 [debug] [Thread-1  ]: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 24: with changed_customers as (
           ^
[0m18:08:52.251540 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6711b436-e95b-43da-83b7-3aad1db9ccc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97bee0>]}
[0m18:08:52.251937 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model main_silver.silver_transform ....... [[31mERROR[0m in 0.10s]
[0m18:08:52.252253 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:08:52.252533 [debug] [Thread-4  ]: Marking all children of 'model.data_lab_new.silver_transform' to be skipped because of status 'error'.  Reason: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 24: with changed_customers as (
           ^.
[0m18:08:52.253075 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:52.253263 [debug] [MainThread]: On master: BEGIN
[0m18:08:52.253416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:52.253723 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:52.253880 [debug] [MainThread]: On master: COMMIT
[0m18:08:52.254028 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:52.254173 [debug] [MainThread]: On master: COMMIT
[0m18:08:52.254398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:52.254595 [debug] [MainThread]: On master: Close
[0m18:08:52.254807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:52.254959 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:08:52.255120 [info ] [MainThread]: 
[0m18:08:52.255289 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:08:52.255619 [debug] [MainThread]: Command end result
[0m18:08:52.269442 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:08:52.270933 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:08:52.280340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:08:52.280516 [info ] [MainThread]: 
[0m18:08:52.280706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:08:52.280867 [info ] [MainThread]: 
[0m18:08:52.281058 [error] [MainThread]: [31mFailure in model silver_transform (models/silver/silver_transform.sql)[0m
[0m18:08:52.281240 [error] [MainThread]:   Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 24: with changed_customers as (
           ^
[0m18:08:52.281386 [info ] [MainThread]: 
[0m18:08:52.281556 [info ] [MainThread]:   compiled code at target/compiled/data_lab_new/models/silver/silver_transform.sql
[0m18:08:52.281702 [info ] [MainThread]: 
[0m18:08:52.281863 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:08:52.283478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6436015, "process_in_blocks": "0", "process_kernel_time": 0.193919, "process_mem_max_rss": "141131776", "process_out_blocks": "0", "process_user_time": 0.936447}
[0m18:08:52.283686 [debug] [MainThread]: Command `dbt run` failed at 18:08:52.283648 after 0.64 seconds
[0m18:08:52.283883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c28a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5944f0>]}
[0m18:08:52.284073 [debug] [MainThread]: Flushing usage events
[0m18:08:53.405448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:27.336051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4354c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4352e0>]}


============================== 18:09:27.338492 | 72d331ea-2d45-413a-9c4e-17dc57b256b0 ==============================
[0m18:09:27.338492 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:09:27.338771 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/Users/davidhe/data-lab-new/logs', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:09:27.455492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b52a340>]}
[0m18:09:27.479901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b405e50>]}
[0m18:09:27.481299 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:09:27.534005 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:09:27.612818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:27.613013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:27.615924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:09:27.627025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba09130>]}
[0m18:09:27.670658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:09:27.673343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:09:27.701343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba32b50>]}
[0m18:09:27.701618 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:09:27.701796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b874220>]}
[0m18:09:27.702370 [info ] [MainThread]: 
[0m18:09:27.702548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:27.702693 [info ] [MainThread]: 
[0m18:09:27.702941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:09:27.703385 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:09:27.798339 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:09:27.798563 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:09:27.798700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:27.803863 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:09:27.804391 [debug] [ThreadPool]: On list_lab: Close
[0m18:09:27.804699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:09:27.804920 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:09:27.807970 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:09:27.808149 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:09:27.808301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:27.808647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:27.809152 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:09:27.809294 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:09:27.809492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:27.809624 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:09:27.809751 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:09:27.809960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:27.810281 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:09:27.810419 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:09:27.810541 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:09:27.810740 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:27.810892 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:09:27.811308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:09:27.813608 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:09:27.813751 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:09:27.813876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:27.814093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:27.814219 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:09:27.814349 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:09:27.818031 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:09:27.818483 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:09:27.819311 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:09:27.819446 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:09:27.819740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba32c10>]}
[0m18:09:27.819940 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:27.820069 [debug] [MainThread]: On master: BEGIN
[0m18:09:27.820187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:27.820383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:27.820508 [debug] [MainThread]: On master: COMMIT
[0m18:09:27.820632 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:27.820752 [debug] [MainThread]: On master: COMMIT
[0m18:09:27.820938 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:27.821073 [debug] [MainThread]: On master: Close
[0m18:09:27.822070 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:09:27.822295 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:09:27.822576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:09:27.822731 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:09:27.828812 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:09:27.831748 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:09:27.857272 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:09:27.857569 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122180927847851"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

with changed_customers as (
    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select coalesce(max(most_recent_order_date), '1900-01-01')
            from "lab"."main_silver"."silver_transform"
        )
    
),

with customer_orders as (
    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
)

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '72d331ea-2d45-413a-9c4e-17dc57b256b0' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        where c.customer_id in (
            select c.customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:09:27.857758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:27.858139 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122180927847851"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

with changed_customers as (
    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select coalesce(max(most_recent_order_date), '1900-01-01')
            from "lab"."main_silver"."silver_transform"
        )
    
),

with customer_orders as (
    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id
)

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '72d331ea-2d45-413a-9c4e-17dc57b256b0' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        where c.customer_id in (
            select c.customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:09:27.858315 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m18:09:27.858520 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:09:27.870757 [debug] [Thread-1  ]: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 24: with changed_customers as (
           ^
[0m18:09:27.871686 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d331ea-2d45-413a-9c4e-17dc57b256b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab7dc0>]}
[0m18:09:27.871977 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model main_silver.silver_transform ....... [[31mERROR[0m in 0.05s]
[0m18:09:27.872246 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:09:27.872458 [debug] [Thread-4  ]: Marking all children of 'model.data_lab_new.silver_transform' to be skipped because of status 'error'.  Reason: Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 24: with changed_customers as (
           ^.
[0m18:09:27.872925 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:27.873064 [debug] [MainThread]: On master: BEGIN
[0m18:09:27.873187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:27.873436 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:27.873580 [debug] [MainThread]: On master: COMMIT
[0m18:09:27.873713 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:27.873833 [debug] [MainThread]: On master: COMMIT
[0m18:09:27.874010 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:27.874137 [debug] [MainThread]: On master: Close
[0m18:09:27.874290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:27.874410 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:09:27.874541 [info ] [MainThread]: 
[0m18:09:27.874692 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m18:09:27.874966 [debug] [MainThread]: Command end result
[0m18:09:27.891990 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:09:27.894212 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:09:27.903158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:09:27.903335 [info ] [MainThread]: 
[0m18:09:27.903523 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:09:27.903685 [info ] [MainThread]: 
[0m18:09:27.903868 [error] [MainThread]: [31mFailure in model silver_transform (models/silver/silver_transform.sql)[0m
[0m18:09:27.904046 [error] [MainThread]:   Runtime Error in model silver_transform (models/silver/silver_transform.sql)
  Parser Error: syntax error at or near "with"
  
  LINE 24: with changed_customers as (
           ^
[0m18:09:27.904194 [info ] [MainThread]: 
[0m18:09:27.904357 [info ] [MainThread]:   compiled code at target/compiled/data_lab_new/models/silver/silver_transform.sql
[0m18:09:27.904498 [info ] [MainThread]: 
[0m18:09:27.904654 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:09:27.905907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.60493666, "process_in_blocks": "0", "process_kernel_time": 0.189762, "process_mem_max_rss": "141066240", "process_out_blocks": "0", "process_user_time": 0.92062}
[0m18:09:27.906082 [debug] [MainThread]: Command `dbt run` failed at 18:09:27.906049 after 0.61 seconds
[0m18:09:27.906257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba32bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dccd30>]}
[0m18:09:27.906423 [debug] [MainThread]: Flushing usage events
[0m18:09:29.041267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:06.841576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109710520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109710340>]}


============================== 18:10:06.844108 | 6c56d8d2-1b54-49df-b11a-b090c5eebbfd ==============================
[0m18:10:06.844108 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:10:06.844387 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_path': '/Users/davidhe/data-lab-new/logs', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True'}
[0m18:10:06.962883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c56d8d2-1b54-49df-b11a-b090c5eebbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109710340>]}
[0m18:10:06.988255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c56d8d2-1b54-49df-b11a-b090c5eebbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109827f10>]}
[0m18:10:06.989895 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:10:07.043920 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:10:07.116015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:07.116296 [debug] [MainThread]: Partial parsing: updated file: data_lab_new://models/silver/silver_transform.sql
[0m18:10:07.212198 [error] [MainThread]: Encountered an error:
Compilation Error in model silver_transform (models/silver/silver_transform.sql)
  expected token ',', got 'updates'
    line 4
      incremental_strategy = 'merge'  -- ensures updates happen for existing customers
[0m18:10:07.213746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.40742254, "process_in_blocks": "0", "process_kernel_time": 0.148266, "process_mem_max_rss": "128663552", "process_out_blocks": "0", "process_user_time": 0.834472}
[0m18:10:07.213957 [debug] [MainThread]: Command `dbt run` failed at 18:10:07.213919 after 0.41 seconds
[0m18:10:07.214126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098519d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109851be0>]}
[0m18:10:07.214295 [debug] [MainThread]: Flushing usage events
[0m18:10:08.099925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:27.155394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9723d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f42e0>]}


============================== 18:10:27.157720 | b5dd8362-5ae5-43e2-a950-e1a50d48dbc0 ==============================
[0m18:10:27.157720 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:10:27.158004 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_cache_events': 'False', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'target_path': 'None'}
[0m18:10:27.275543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b82d340>]}
[0m18:10:27.300521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9bb910>]}
[0m18:10:27.302090 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:10:27.363981 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:10:27.439515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:27.439742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:27.442803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:10:27.454142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb5130>]}
[0m18:10:27.498120 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:10:27.500789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:10:27.526272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfdebb0>]}
[0m18:10:27.526567 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:10:27.526762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc83eb0>]}
[0m18:10:27.527358 [info ] [MainThread]: 
[0m18:10:27.527538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:27.527682 [info ] [MainThread]: 
[0m18:10:27.527922 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:27.528346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:10:27.622997 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:10:27.623229 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:10:27.623368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:27.628630 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:10:27.629200 [debug] [ThreadPool]: On list_lab: Close
[0m18:10:27.629496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:10:27.629698 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:10:27.632669 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:27.632812 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:10:27.632945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:27.633256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:27.633718 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:27.633846 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:10:27.634032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:27.634155 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:27.634278 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:10:27.634470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:27.634781 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:10:27.634915 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:27.635034 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:10:27.635228 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:27.635373 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:10:27.635796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:10:27.638142 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:10:27.638274 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:10:27.638391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:27.638596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:27.638737 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:10:27.638868 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:10:27.642532 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:10:27.642987 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:10:27.643952 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:10:27.644098 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:10:27.644408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac2da30>]}
[0m18:10:27.644604 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:27.644732 [debug] [MainThread]: On master: BEGIN
[0m18:10:27.644849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:27.645053 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:27.645176 [debug] [MainThread]: On master: COMMIT
[0m18:10:27.645293 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:27.645414 [debug] [MainThread]: On master: COMMIT
[0m18:10:27.645590 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:27.645731 [debug] [MainThread]: On master: Close
[0m18:10:27.646804 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:10:27.647023 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:10:27.647301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:10:27.647453 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:10:27.653516 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:10:27.656480 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:10:27.681830 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.682082 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122181027672515"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        -- only update rows for customers who have new orders
        where c.customer_id in (
            select customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:10:27.682262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:27.683876 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:10:27.687049 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.687216 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:10:27.687453 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:27.687610 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.687759 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122181027672515'
      
      
      order by ordinal_position

  
[0m18:10:27.688634 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:27.690797 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.690977 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:10:27.691794 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:27.694919 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.695083 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:10:27.695888 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:27.696531 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.696709 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:10:27.696966 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:27.724911 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:10:27.731617 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.731795 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */


    MERGE INTO "lab"."main_silver"."silver_transform" AS DBT_INTERNAL_DEST
        USING "silver_transform__dbt_tmp20260122181027672515" AS DBT_INTERNAL_SOURCE
        
            
                
            
        
        ON (DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m18:10:27.732643 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:27.736623 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:10:27.736787 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:27.736932 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:10:27.737148 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:27.737945 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:10:27.738997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5dd8362-5ae5-43e2-a950-e1a50d48dbc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ff1c0>]}
[0m18:10:27.739275 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m18:10:27.739540 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:10:27.739992 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:27.740135 [debug] [MainThread]: On master: BEGIN
[0m18:10:27.740258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:27.740469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:27.740593 [debug] [MainThread]: On master: COMMIT
[0m18:10:27.740714 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:27.740832 [debug] [MainThread]: On master: COMMIT
[0m18:10:27.741005 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:27.741134 [debug] [MainThread]: On master: Close
[0m18:10:27.741285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:27.741402 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:10:27.741530 [info ] [MainThread]: 
[0m18:10:27.741681 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m18:10:27.741954 [debug] [MainThread]: Command end result
[0m18:10:27.759010 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:10:27.761795 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:10:27.774195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:10:27.774357 [info ] [MainThread]: 
[0m18:10:27.774559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:27.774712 [info ] [MainThread]: 
[0m18:10:27.774879 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:27.776363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.65564495, "process_in_blocks": "0", "process_kernel_time": 0.182949, "process_mem_max_rss": "145063936", "process_out_blocks": "0", "process_user_time": 0.969508}
[0m18:10:27.776556 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:27.776519 after 0.66 seconds
[0m18:10:27.776743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9723d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9bb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9dca0>]}
[0m18:10:27.776965 [debug] [MainThread]: Flushing usage events
[0m18:10:28.914740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:35.835318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9694c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9692e0>]}


============================== 18:10:35.837697 | 8cbfc52e-5baa-4aa6-b714-91ea30b8aa96 ==============================
[0m18:10:35.837697 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:10:35.838027 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:35.953487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da60d00>]}
[0m18:10:35.978164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93ae50>]}
[0m18:10:35.979668 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:10:36.032858 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:10:36.111810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:36.112003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:36.114932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:10:36.125728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df3d130>]}
[0m18:10:36.168742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:10:36.171420 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:10:36.197871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df67b50>]}
[0m18:10:36.198154 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:10:36.198330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dda8220>]}
[0m18:10:36.198919 [info ] [MainThread]: 
[0m18:10:36.199101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:36.199243 [info ] [MainThread]: 
[0m18:10:36.199485 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:36.199921 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:10:36.299966 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:10:36.300194 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:10:36.300336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:36.305631 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:10:36.306151 [debug] [ThreadPool]: On list_lab: Close
[0m18:10:36.306454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:10:36.306680 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:10:36.309667 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:36.309819 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:10:36.309947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:36.310267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:36.310779 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:36.310916 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:10:36.311107 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:36.311232 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:36.311356 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:10:36.311555 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:36.311867 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:10:36.311998 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:10:36.312120 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:10:36.312293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:36.312421 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:10:36.312823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:10:36.315135 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:10:36.315272 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:10:36.315391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:36.315596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:36.315715 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:10:36.315843 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:10:36.319568 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:10:36.320079 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:10:36.320909 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:10:36.321063 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:10:36.321389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df67c10>]}
[0m18:10:36.321621 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:36.321747 [debug] [MainThread]: On master: BEGIN
[0m18:10:36.321867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:36.322061 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:36.322185 [debug] [MainThread]: On master: COMMIT
[0m18:10:36.322307 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:36.322427 [debug] [MainThread]: On master: COMMIT
[0m18:10:36.322596 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:36.322728 [debug] [MainThread]: On master: Close
[0m18:10:36.323735 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:10:36.323956 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:10:36.324234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:10:36.324390 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:10:36.330721 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:10:36.333924 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:10:36.359498 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.359760 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122181036350456"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        -- only update rows for customers who have new orders
        where c.customer_id in (
            select customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:10:36.359945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:36.361746 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:10:36.364919 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.365094 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:10:36.365334 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:36.365484 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.365634 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122181036350456'
      
      
      order by ordinal_position

  
[0m18:10:36.366480 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:36.368598 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.368763 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:10:36.369553 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:36.372749 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.372920 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:10:36.373700 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:10:36.374317 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.374471 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:10:36.374695 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:36.402716 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:10:36.410287 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.410471 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */


    MERGE INTO "lab"."main_silver"."silver_transform" AS DBT_INTERNAL_DEST
        USING "silver_transform__dbt_tmp20260122181036350456" AS DBT_INTERNAL_SOURCE
        
            
                
            
        
        ON (DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m18:10:36.411138 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:36.415123 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:10:36.415285 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:10:36.415431 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:10:36.415640 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:10:36.416485 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:10:36.417514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbfc52e-5baa-4aa6-b714-91ea30b8aa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e287130>]}
[0m18:10:36.417797 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m18:10:36.418059 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:10:36.418496 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:36.418643 [debug] [MainThread]: On master: BEGIN
[0m18:10:36.418790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:36.419022 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:36.419161 [debug] [MainThread]: On master: COMMIT
[0m18:10:36.419293 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:36.419417 [debug] [MainThread]: On master: COMMIT
[0m18:10:36.419618 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:36.419787 [debug] [MainThread]: On master: Close
[0m18:10:36.419966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:36.420095 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:10:36.420231 [info ] [MainThread]: 
[0m18:10:36.420384 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:10:36.420664 [debug] [MainThread]: Command end result
[0m18:10:36.437599 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:10:36.440367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:10:36.450608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:10:36.450771 [info ] [MainThread]: 
[0m18:10:36.450980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:36.451129 [info ] [MainThread]: 
[0m18:10:36.451281 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:36.452673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.71132183, "process_in_blocks": "0", "process_kernel_time": 0.178915, "process_mem_max_rss": "145096704", "process_out_blocks": "0", "process_user_time": 0.949333}
[0m18:10:36.452849 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:36.452815 after 0.71 seconds
[0m18:10:36.453016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df67be0>]}
[0m18:10:36.453180 [debug] [MainThread]: Flushing usage events
[0m18:10:37.421133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:24.478130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c326430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a92e0>]}


============================== 18:11:24.480680 | efcb4f1f-3dd7-4e47-a510-8e10c380e8c0 ==============================
[0m18:11:24.480680 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:11:24.480963 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/davidhe/data-lab-new', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'log_path': '/Users/davidhe/data-lab-new/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m18:11:24.601673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4810d0>]}
[0m18:11:24.626018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc772e0>]}
[0m18:11:24.627609 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:11:24.681520 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:11:24.752094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:24.752298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:24.755336 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:11:24.766252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d969130>]}
[0m18:11:24.809845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:11:24.812463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:11:24.838116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d993ca0>]}
[0m18:11:24.838397 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:11:24.838576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d594400>]}
[0m18:11:24.839167 [info ] [MainThread]: 
[0m18:11:24.839355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:24.839504 [info ] [MainThread]: 
[0m18:11:24.839755 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:11:24.840202 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:11:24.939398 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:11:24.939634 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:11:24.939772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:24.944993 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:11:24.945522 [debug] [ThreadPool]: On list_lab: Close
[0m18:11:24.945837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:11:24.946053 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:11:24.948995 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:11:24.949140 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:11:24.949268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:24.949592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:24.950073 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:11:24.950205 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:11:24.950390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:24.950512 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:11:24.950634 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:11:24.950827 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:24.951139 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:11:24.951272 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:11:24.951390 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:11:24.951599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:24.951763 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:11:24.952206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:11:24.954565 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:11:24.954711 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:11:24.954835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:24.955037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:24.955157 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:11:24.955283 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:11:24.958911 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:11:24.959372 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:11:24.960219 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:11:24.960360 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:11:24.960653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6619a0>]}
[0m18:11:24.960867 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:24.961000 [debug] [MainThread]: On master: BEGIN
[0m18:11:24.961123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:24.961324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:24.961451 [debug] [MainThread]: On master: COMMIT
[0m18:11:24.961574 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:24.961695 [debug] [MainThread]: On master: COMMIT
[0m18:11:24.961904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:24.962083 [debug] [MainThread]: On master: Close
[0m18:11:24.963142 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:11:24.963383 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:11:24.963653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:11:24.963808 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:11:24.969842 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:11:24.972809 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:11:24.998323 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:24.998582 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122181124988933"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id

    
        -- only update rows for customers who have new orders
        where c.customer_id in (
            select customer_id from changed_customers
        )
    

)

select * from final
    );
  
  
  
[0m18:11:24.998771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:25.000473 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:11:25.003597 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.003763 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:11:25.003988 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:11:25.004133 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.004286 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122181124988933'
      
      
      order by ordinal_position

  
[0m18:11:25.005119 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:11:25.007241 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.007405 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:11:25.008205 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:11:25.011384 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.011565 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:11:25.012328 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:11:25.012932 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.013084 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:11:25.013398 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:11:25.041358 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:11:25.047579 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.047744 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */


    MERGE INTO "lab"."main_silver"."silver_transform" AS DBT_INTERNAL_DEST
        USING "silver_transform__dbt_tmp20260122181124988933" AS DBT_INTERNAL_SOURCE
        
            
                
            
        
        ON (DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m18:11:25.048337 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:11:25.052342 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:11:25.052518 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:11:25.052670 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:11:25.052878 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:11:25.053722 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:11:25.054809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efcb4f1f-3dd7-4e47-a510-8e10c380e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd53490>]}
[0m18:11:25.055087 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m18:11:25.055351 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:11:25.055818 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:25.055960 [debug] [MainThread]: On master: BEGIN
[0m18:11:25.056089 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:25.056298 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:25.056422 [debug] [MainThread]: On master: COMMIT
[0m18:11:25.056541 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:25.056659 [debug] [MainThread]: On master: COMMIT
[0m18:11:25.056826 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:25.056952 [debug] [MainThread]: On master: Close
[0m18:11:25.057106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:25.057234 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:11:25.057362 [info ] [MainThread]: 
[0m18:11:25.057514 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:11:25.057781 [debug] [MainThread]: Command end result
[0m18:11:25.075038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:11:25.078068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:11:25.089178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:11:25.089338 [info ] [MainThread]: 
[0m18:11:25.089536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:25.089693 [info ] [MainThread]: 
[0m18:11:25.089849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:11:25.091309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6488383, "process_in_blocks": "0", "process_kernel_time": 0.190081, "process_mem_max_rss": "145244160", "process_out_blocks": "0", "process_user_time": 0.949783}
[0m18:11:25.091491 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:25.091456 after 0.65 seconds
[0m18:11:25.091660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c326430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d673670>]}
[0m18:11:25.091832 [debug] [MainThread]: Flushing usage events
[0m18:11:26.186651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:16.863046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a564c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad9370>]}


============================== 18:12:16.865481 | 94b02f9b-16a8-441b-b2a5-7e0953f915a2 ==============================
[0m18:12:16.865481 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:12:16.865794 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/davidhe/data-lab-new/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:12:16.982276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94b02f9b-16a8-441b-b2a5-7e0953f915a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7d400>]}
[0m18:12:17.007224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94b02f9b-16a8-441b-b2a5-7e0953f915a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108365730>]}
[0m18:12:17.008812 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:12:17.062222 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:12:17.140410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:17.140618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:17.143624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:12:17.154449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94b02f9b-16a8-441b-b2a5-7e0953f915a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109099130>]}
[0m18:12:17.197212 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:12:17.200109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:12:17.219914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94b02f9b-16a8-441b-b2a5-7e0953f915a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907d2e0>]}
[0m18:12:17.220206 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:12:17.220381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94b02f9b-16a8-441b-b2a5-7e0953f915a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7ad90>]}
[0m18:12:17.220938 [info ] [MainThread]: 
[0m18:12:17.221115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:17.221258 [info ] [MainThread]: 
[0m18:12:17.221506 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:17.221953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:12:17.317770 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:12:17.317999 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:12:17.318140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:17.322389 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:12:17.322552 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:12:17.322896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:17.323051 [debug] [MainThread]: Connection 'list_lab' was properly closed.
[0m18:12:17.323189 [info ] [MainThread]: 
[0m18:12:17.323360 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:12:17.323614 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/./database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 942) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m18:12:17.324715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5611772, "process_in_blocks": "0", "process_kernel_time": 0.165933, "process_mem_max_rss": "132562944", "process_out_blocks": "0", "process_user_time": 0.846867}
[0m18:12:17.324897 [debug] [MainThread]: Command `dbt run` failed at 18:12:17.324862 after 0.56 seconds
[0m18:12:17.325061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a564c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eceeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090aefd0>]}
[0m18:12:17.325230 [debug] [MainThread]: Flushing usage events
[0m18:12:18.513082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:30.157538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969c370>]}


============================== 18:12:30.159759 | b781ea17-4784-4f92-a78d-1d347f70c4c6 ==============================
[0m18:12:30.159759 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:12:30.160035 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/davidhe/data-lab-new', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'quiet': 'False', 'log_path': '/Users/davidhe/data-lab-new/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m18:12:30.278120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b781ea17-4784-4f92-a78d-1d347f70c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973bd00>]}
[0m18:12:30.304080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b781ea17-4784-4f92-a78d-1d347f70c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f29730>]}
[0m18:12:30.305751 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:12:30.359466 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:12:30.439139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:30.439344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:30.442350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:12:30.453303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b781ea17-4784-4f92-a78d-1d347f70c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5d130>]}
[0m18:12:30.496831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:12:30.499488 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:12:30.525346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b781ea17-4784-4f92-a78d-1d347f70c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c412e0>]}
[0m18:12:30.525620 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:12:30.525794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b781ea17-4784-4f92-a78d-1d347f70c4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983ed90>]}
[0m18:12:30.526385 [info ] [MainThread]: 
[0m18:12:30.526562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:30.526707 [info ] [MainThread]: 
[0m18:12:30.526955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:30.527388 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:12:30.624851 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:12:30.625071 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:12:30.625209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:30.629580 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:12:30.629733 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:12:30.630079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:30.630230 [debug] [MainThread]: Connection 'list_lab' was properly closed.
[0m18:12:30.630370 [info ] [MainThread]: 
[0m18:12:30.630541 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:12:30.630802 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/davidhe/data-lab-new/./database/lab.db": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 942) by user davidhe. See also https://duckdb.org/docs/stable/connect/concurrency
[0m18:12:30.631908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.50823456, "process_in_blocks": "0", "process_kernel_time": 0.174837, "process_mem_max_rss": "132562944", "process_out_blocks": "0", "process_user_time": 0.849268}
[0m18:12:30.632089 [debug] [MainThread]: Command `dbt run` failed at 18:12:30.632053 after 0.51 seconds
[0m18:12:30.632250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a92eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c72fd0>]}
[0m18:12:30.632420 [debug] [MainThread]: Flushing usage events
[0m18:12:31.826199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:39.566955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a766400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e8280>]}


============================== 18:12:39.569118 | ebf8dae9-b0c7-4299-800b-179ae24a1865 ==============================
[0m18:12:39.569118 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:12:39.569400 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'write_json': 'True'}
[0m18:12:39.688474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090293a0>]}
[0m18:12:39.714701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b78a4f0>]}
[0m18:12:39.716255 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:12:39.770495 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:12:39.841144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:39.841373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:39.844461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:12:39.855716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bda9130>]}
[0m18:12:39.895240 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:12:39.898127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:12:39.927184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd27c0>]}
[0m18:12:39.927455 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:12:39.927626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd76040>]}
[0m18:12:39.928203 [info ] [MainThread]: 
[0m18:12:39.928386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:39.928536 [info ] [MainThread]: 
[0m18:12:39.928784 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:39.929187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:12:40.032932 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:12:40.033208 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:12:40.033349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:40.038656 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:12:40.039211 [debug] [ThreadPool]: On list_lab: Close
[0m18:12:40.039516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:12:40.039723 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:12:40.042789 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:12:40.042941 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:12:40.043072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:40.043404 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:40.043900 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:12:40.044036 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:12:40.044223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:40.044349 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:12:40.044473 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:12:40.044664 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:40.044975 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:12:40.045107 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:12:40.045228 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:12:40.045430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:40.045600 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:12:40.046049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:12:40.048420 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:12:40.048555 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:12:40.048676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:40.048881 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:40.049013 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:12:40.049143 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:12:40.053004 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:12:40.053519 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:12:40.054397 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:12:40.054540 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:12:40.054847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb3760>]}
[0m18:12:40.055046 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:40.055182 [debug] [MainThread]: On master: BEGIN
[0m18:12:40.055302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:40.055500 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:40.055626 [debug] [MainThread]: On master: COMMIT
[0m18:12:40.055749 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:40.055869 [debug] [MainThread]: On master: COMMIT
[0m18:12:40.056060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:40.056208 [debug] [MainThread]: On master: Close
[0m18:12:40.057299 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:12:40.057520 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:12:40.057796 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:12:40.057982 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:12:40.064189 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:12:40.067526 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:12:40.093772 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.094031 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122181240084458"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        'ebf8dae9-b0c7-4299-800b-179ae24a1865' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id


)

select * from final
    );
  
  
  
[0m18:12:40.094212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:40.095791 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:12:40.098886 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.099058 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:12:40.099297 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:12:40.099444 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.099598 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122181240084458'
      
      
      order by ordinal_position

  
[0m18:12:40.100441 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:12:40.102627 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.102801 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:12:40.103632 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:12:40.106794 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.106963 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:12:40.107738 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:12:40.108335 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.108485 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:12:40.108706 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:12:40.137601 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:12:40.144061 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.144265 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */


    MERGE INTO "lab"."main_silver"."silver_transform" AS DBT_INTERNAL_DEST
        USING "silver_transform__dbt_tmp20260122181240084458" AS DBT_INTERNAL_SOURCE
        
            
                
            
        
        ON (DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m18:12:40.145001 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:12:40.149081 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:12:40.149253 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:12:40.149397 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:12:40.149622 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:12:40.150469 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:12:40.151605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebf8dae9-b0c7-4299-800b-179ae24a1865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f2730>]}
[0m18:12:40.151908 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m18:12:40.152170 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:12:40.152670 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:40.152834 [debug] [MainThread]: On master: BEGIN
[0m18:12:40.152967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:40.153199 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:40.153329 [debug] [MainThread]: On master: COMMIT
[0m18:12:40.153453 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:40.153574 [debug] [MainThread]: On master: COMMIT
[0m18:12:40.153751 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:40.153881 [debug] [MainThread]: On master: Close
[0m18:12:40.154036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:40.154153 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:12:40.154281 [info ] [MainThread]: 
[0m18:12:40.154433 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:12:40.154717 [debug] [MainThread]: Command end result
[0m18:12:40.172854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:12:40.175539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:12:40.185864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:12:40.186042 [info ] [MainThread]: 
[0m18:12:40.186240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:40.186393 [info ] [MainThread]: 
[0m18:12:40.186561 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:12:40.188025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.65520257, "process_in_blocks": "0", "process_kernel_time": 0.197984, "process_mem_max_rss": "145309696", "process_out_blocks": "0", "process_user_time": 0.967657}
[0m18:12:40.188209 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:40.188174 after 0.66 seconds
[0m18:12:40.188380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a766400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b78a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd9cee0>]}
[0m18:12:40.188552 [debug] [MainThread]: Flushing usage events
[0m18:12:41.247723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:19.158436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c252430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d52e0>]}


============================== 18:13:19.160938 | aecdcb03-ae7b-40b1-bd2c-efa601c88cb7 ==============================
[0m18:13:19.160938 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:13:19.161264 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True'}
[0m18:13:19.278448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ad3d0>]}
[0m18:13:19.303982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cba32e0>]}
[0m18:13:19.305555 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:19.358579 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:13:19.441530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:19.441759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:19.444853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:13:19.455524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d894130>]}
[0m18:13:19.496281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:13:19.502936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:13:19.521808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8bfca0>]}
[0m18:13:19.522072 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:13:19.522250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4bf400>]}
[0m18:13:19.522804 [info ] [MainThread]: 
[0m18:13:19.522980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:19.523127 [info ] [MainThread]: 
[0m18:13:19.523373 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:19.523805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:13:19.621287 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:13:19.621513 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:13:19.621653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:19.626814 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:13:19.627372 [debug] [ThreadPool]: On list_lab: Close
[0m18:13:19.627678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:13:19.627881 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:13:19.630850 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:13:19.630997 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:13:19.631124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:19.631454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:19.631936 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:13:19.632070 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:13:19.632259 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:19.632384 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:13:19.632508 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:13:19.632703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:19.633013 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:13:19.633146 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:13:19.633267 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:13:19.633442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:19.633571 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:13:19.633979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:13:19.636396 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:13:19.636551 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:13:19.636678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:19.636890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:19.637015 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:13:19.637143 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:13:19.640755 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:13:19.641190 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:13:19.642067 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:13:19.642205 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:13:19.642426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8679a0>]}
[0m18:13:19.642634 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:19.642768 [debug] [MainThread]: On master: BEGIN
[0m18:13:19.642891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:19.643094 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:19.643218 [debug] [MainThread]: On master: COMMIT
[0m18:13:19.643339 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:19.643459 [debug] [MainThread]: On master: COMMIT
[0m18:13:19.643655 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:19.643821 [debug] [MainThread]: On master: Close
[0m18:13:19.644883 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:13:19.645114 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:13:19.645340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:13:19.645493 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:13:19.650651 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:13:19.653613 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:13:19.680224 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:13:19.682360 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:13:19.682538 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:13:19.682683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:19.682984 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:13:19.683130 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:13:19.683290 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

  
    
    

    create  table
      "lab"."main_silver"."silver_transform"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id


)

select * from final
    );
  
  
  
[0m18:13:19.685409 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:13:19.690897 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:13:19.691074 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:13:19.691225 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:13:19.691766 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:13:19.692600 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:13:19.693441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aecdcb03-ae7b-40b1-bd2c-efa601c88cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc6e130>]}
[0m18:13:19.693767 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.05s]
[0m18:13:19.694039 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:13:19.694497 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:19.694651 [debug] [MainThread]: On master: BEGIN
[0m18:13:19.694798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:19.695014 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:19.695154 [debug] [MainThread]: On master: COMMIT
[0m18:13:19.695288 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:19.695412 [debug] [MainThread]: On master: COMMIT
[0m18:13:19.695609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:19.695794 [debug] [MainThread]: On master: Close
[0m18:13:19.695983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:19.696110 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:13:19.696248 [info ] [MainThread]: 
[0m18:13:19.696405 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m18:13:19.696708 [debug] [MainThread]: Command end result
[0m18:13:19.708974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:13:19.711431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:13:19.720456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:13:19.720608 [info ] [MainThread]: 
[0m18:13:19.720817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:19.720970 [info ] [MainThread]: 
[0m18:13:19.721136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:13:19.722351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66309524, "process_in_blocks": "0", "process_kernel_time": 0.193678, "process_mem_max_rss": "149716992", "process_out_blocks": "0", "process_user_time": 0.924945}
[0m18:13:19.722524 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:19.722490 after 0.66 seconds
[0m18:13:19.722690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c252430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6ff1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8bfc10>]}
[0m18:13:19.722857 [debug] [MainThread]: Flushing usage events
[0m18:13:20.978729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:01.457268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0d2e0>]}


============================== 18:14:01.459593 | 5c2f9054-89fe-4556-a449-8c3b4fd51c47 ==============================
[0m18:14:01.459593 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:14:01.459878 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'empty': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new'}
[0m18:14:01.575759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade8220>]}
[0m18:14:01.600385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5dd2e0>]}
[0m18:14:01.601853 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:14:01.655069 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:14:01.727929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:01.728122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:01.731088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:14:01.741652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2df130>]}
[0m18:14:01.784160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:14:01.787139 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:14:01.809943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30aca0>]}
[0m18:14:01.810198 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:14:01.810380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef9400>]}
[0m18:14:01.810939 [info ] [MainThread]: 
[0m18:14:01.811124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:01.811269 [info ] [MainThread]: 
[0m18:14:01.811523 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:14:01.811954 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:14:01.926414 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:14:01.926650 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:14:01.926794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:01.931973 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:14:01.932519 [debug] [ThreadPool]: On list_lab: Close
[0m18:14:01.932840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:14:01.933077 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:14:01.936082 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:14:01.936242 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:14:01.936375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:01.936704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:01.937194 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:14:01.937331 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:14:01.937523 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:01.937647 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:14:01.937773 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:14:01.937979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:01.938316 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:14:01.938463 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:14:01.938589 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:14:01.938776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:01.938904 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:14:01.939301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:14:01.941790 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:14:01.941940 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:14:01.942064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:01.942267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:01.942391 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:14:01.942524 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:14:01.946114 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:14:01.946587 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:14:01.947459 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:14:01.947599 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:14:01.947906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b29a0>]}
[0m18:14:01.948104 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:01.948234 [debug] [MainThread]: On master: BEGIN
[0m18:14:01.948354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:01.948550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:01.948675 [debug] [MainThread]: On master: COMMIT
[0m18:14:01.948798 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:01.948919 [debug] [MainThread]: On master: COMMIT
[0m18:14:01.949103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:01.949242 [debug] [MainThread]: On master: Close
[0m18:14:01.950263 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:14:01.950484 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:14:01.950760 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:14:01.950914 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:14:01.956992 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:14:01.959770 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:14:01.985126 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:01.985396 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122181401975940"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '5c2f9054-89fe-4556-a449-8c3b4fd51c47' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id


)

select * from final
    );
  
  
  
[0m18:14:01.985578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:14:01.987170 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:14:01.990575 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:01.990769 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:14:01.991030 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:14:01.991179 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:01.991350 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122181401975940'
      
      
      order by ordinal_position

  
[0m18:14:01.992226 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:14:01.994313 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:01.994480 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:14:01.995268 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:14:01.998359 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:01.998518 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:14:01.999295 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:14:01.999887 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:02.000040 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:14:02.000261 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:14:02.028323 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:14:02.033564 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:02.033747 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */


    MERGE INTO "lab"."main_silver"."silver_transform" AS DBT_INTERNAL_DEST
        USING "silver_transform__dbt_tmp20260122181401975940" AS DBT_INTERNAL_SOURCE
        
            
                
            
        
        ON (DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m18:14:02.034442 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:14:02.038588 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:14:02.038796 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:14:02.038954 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:14:02.039180 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:14:02.040004 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:14:02.040935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2f9054-89fe-4556-a449-8c3b4fd51c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b62a5b0>]}
[0m18:14:02.041215 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m18:14:02.041489 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:14:02.041978 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:02.042123 [debug] [MainThread]: On master: BEGIN
[0m18:14:02.042247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:02.042459 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:02.042589 [debug] [MainThread]: On master: COMMIT
[0m18:14:02.042709 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:02.042828 [debug] [MainThread]: On master: COMMIT
[0m18:14:02.043020 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:02.043164 [debug] [MainThread]: On master: Close
[0m18:14:02.043321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:02.043438 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:14:02.043568 [info ] [MainThread]: 
[0m18:14:02.043715 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:14:02.043990 [debug] [MainThread]: Command end result
[0m18:14:02.059804 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:14:02.062155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:14:02.071787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:14:02.071933 [info ] [MainThread]: 
[0m18:14:02.072134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:02.072283 [info ] [MainThread]: 
[0m18:14:02.072440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:14:02.073799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6504886, "process_in_blocks": "0", "process_kernel_time": 0.199573, "process_mem_max_rss": "144998400", "process_out_blocks": "0", "process_user_time": 0.966303}
[0m18:14:02.073982 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:02.073948 after 0.65 seconds
[0m18:14:02.074143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5dd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14b1f0>]}
[0m18:14:02.074309 [debug] [MainThread]: Flushing usage events
[0m18:14:03.128498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:35.417612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109549490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095492b0>]}


============================== 18:15:35.419986 | 20b34b5e-6106-43ec-b6d1-b9f06ea65f20 ==============================
[0m18:15:35.419986 [info ] [MainThread]: Running with dbt=1.10.18
[0m18:15:35.420253 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/davidhe/data-lab-new/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/davidhe/data-lab-new', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True'}
[0m18:15:35.552678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d89820>]}
[0m18:15:35.581571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109515ee0>]}
[0m18:15:35.583355 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:15:35.638620 [debug] [MainThread]: checksum: 9646db7d1a5f5b9389d9c545d3ebf898b26bc1f63f6b5366f34a6af01d52cb91, vars: {}, profile: , target: , version: 1.10.18
[0m18:15:35.710494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:35.710702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:35.713687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests
[0m18:15:35.724259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b09130>]}
[0m18:15:35.766271 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:15:35.779530 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:15:35.805967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aee100>]}
[0m18:15:35.806273 [info ] [MainThread]: Found 1 model, 456 macros
[0m18:15:35.806451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b23af0>]}
[0m18:15:35.807062 [info ] [MainThread]: 
[0m18:15:35.807256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:35.807411 [info ] [MainThread]: 
[0m18:15:35.807668 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:15:35.808133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_lab'
[0m18:15:35.907124 [debug] [ThreadPool]: Using duckdb connection "list_lab"
[0m18:15:35.907354 [debug] [ThreadPool]: On list_lab: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"lab"'
    
  
  
[0m18:15:35.907500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:35.912763 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:15:35.913312 [debug] [ThreadPool]: On list_lab: Close
[0m18:15:35.913615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab, now create_lab_main_silver)
[0m18:15:35.913817 [debug] [ThreadPool]: Creating schema "database: "lab"
schema: "main_silver"
"
[0m18:15:35.916879 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:15:35.917029 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='lab'
        and type='sqlite'
    
  
[0m18:15:35.917159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:35.917460 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.917928 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:15:35.918063 [debug] [ThreadPool]: On create_lab_main_silver: BEGIN
[0m18:15:35.918251 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.918376 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:15:35.918502 [debug] [ThreadPool]: On create_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "create_lab_main_silver"} */

    
    
        create schema if not exists "lab"."main_silver"
    
[0m18:15:35.918693 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.919005 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:15:35.919141 [debug] [ThreadPool]: Using duckdb connection "create_lab_main_silver"
[0m18:15:35.919264 [debug] [ThreadPool]: On create_lab_main_silver: COMMIT
[0m18:15:35.919463 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.919609 [debug] [ThreadPool]: On create_lab_main_silver: Close
[0m18:15:35.920015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab_main_silver, now list_lab_main_silver)
[0m18:15:35.922364 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:15:35.922501 [debug] [ThreadPool]: On list_lab_main_silver: BEGIN
[0m18:15:35.922622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:35.922841 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.923009 [debug] [ThreadPool]: Using duckdb connection "list_lab_main_silver"
[0m18:15:35.923160 [debug] [ThreadPool]: On list_lab_main_silver: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "connection_name": "list_lab_main_silver"} */
select
      'lab' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'lab'
  
[0m18:15:35.926762 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:15:35.927221 [debug] [ThreadPool]: On list_lab_main_silver: ROLLBACK
[0m18:15:35.928039 [debug] [ThreadPool]: Failed to rollback 'list_lab_main_silver'
[0m18:15:35.928170 [debug] [ThreadPool]: On list_lab_main_silver: Close
[0m18:15:35.928459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109728220>]}
[0m18:15:35.928658 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:35.928786 [debug] [MainThread]: On master: BEGIN
[0m18:15:35.928906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:35.929119 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:35.929268 [debug] [MainThread]: On master: COMMIT
[0m18:15:35.929404 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:35.929535 [debug] [MainThread]: On master: COMMIT
[0m18:15:35.929735 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:35.929876 [debug] [MainThread]: On master: Close
[0m18:15:35.930924 [debug] [Thread-1  ]: Began running node model.data_lab_new.silver_transform
[0m18:15:35.931148 [info ] [Thread-1  ]: 1 of 1 START sql incremental model main_silver.silver_transform ................ [RUN]
[0m18:15:35.931425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab_main_silver, now model.data_lab_new.silver_transform)
[0m18:15:35.931579 [debug] [Thread-1  ]: Began compiling node model.data_lab_new.silver_transform
[0m18:15:35.937403 [debug] [Thread-1  ]: Writing injected SQL for node "model.data_lab_new.silver_transform"
[0m18:15:35.940339 [debug] [Thread-1  ]: Began executing node model.data_lab_new.silver_transform
[0m18:15:35.966202 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:35.966461 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

    
  
    
    

    create temporary table
      "silver_transform__dbt_tmp20260122181535956856"
  
    as (
      

with customers as (

    select
        id as customer_id,
        first_name,
        last_name
    from lab.bronze.customers

),

changed_customers as (

    
        select distinct user_id as customer_id
        from lab.bronze.orders
        where order_date > (
            select
                coalesce(
                    max(this.most_recent_order_date),
                    '1900-01-01'
                )
            -- "lab"."main_silver"."silver_transform" refers to the materialized object of current model
            -- in our case, it's main_silver            
            from "lab"."main_silver"."silver_transform" as this
        )
    

),

customer_orders as (

    select
        o.user_id as customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as most_recent_order_date,
        count(*) as number_of_orders
    from lab.bronze.orders as o
    -- join to changed_customers to only recompute affected customers
    inner join changed_customers as c
        on o.user_id = c.customer_id
    group by o.user_id

),

final as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        co.number_of_orders,
        current_timestamp as _dbt_loaded_at,
        '20b34b5e-6106-43ec-b6d1-b9f06ea65f20' as _dbt_invocation_id
    from customers as c
    inner join customer_orders as co
        on c.customer_id = co.customer_id


)

select * from final
    );
  
  
  
[0m18:15:35.966644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:35.968768 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m18:15:35.971928 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:35.972092 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: BEGIN
[0m18:15:35.972319 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:15:35.972465 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:35.972612 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform__dbt_tmp20260122181535956856'
      
      
      order by ordinal_position

  
[0m18:15:35.973440 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:15:35.975465 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:35.975626 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:15:35.976406 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:15:35.979565 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:35.979749 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_transform'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'lab'
      
      order by ordinal_position

  
[0m18:15:35.980558 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:15:35.981171 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:35.981327 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */
SELECT version()
[0m18:15:35.981550 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:15:36.009006 [debug] [Thread-1  ]: Writing runtime sql for node "model.data_lab_new.silver_transform"
[0m18:15:36.016082 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:36.016247 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: /* {"app": "dbt", "dbt_version": "1.10.18", "profile_name": "data-lab-new", "target_name": "dev", "node_id": "model.data_lab_new.silver_transform"} */


    MERGE INTO "lab"."main_silver"."silver_transform" AS DBT_INTERNAL_DEST
        USING "silver_transform__dbt_tmp20260122181535956856" AS DBT_INTERNAL_SOURCE
        
            
                
            
        
        ON (DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id)
    
    WHEN MATCHED
    THEN
        UPDATE BY NAME
    WHEN NOT MATCHED
        
    THEN
        INSERT BY NAME

  
[0m18:15:36.016991 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m18:15:36.020988 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:15:36.021146 [debug] [Thread-1  ]: Using duckdb connection "model.data_lab_new.silver_transform"
[0m18:15:36.021288 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: COMMIT
[0m18:15:36.021811 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m18:15:36.022603 [debug] [Thread-1  ]: On model.data_lab_new.silver_transform: Close
[0m18:15:36.023509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b34b5e-6106-43ec-b6d1-b9f06ea65f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e53130>]}
[0m18:15:36.023780 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model main_silver.silver_transform ........... [[32mOK[0m in 0.09s]
[0m18:15:36.024044 [debug] [Thread-1  ]: Finished running node model.data_lab_new.silver_transform
[0m18:15:36.024483 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:36.024625 [debug] [MainThread]: On master: BEGIN
[0m18:15:36.024749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:36.024954 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:36.025096 [debug] [MainThread]: On master: COMMIT
[0m18:15:36.025222 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:36.025345 [debug] [MainThread]: On master: COMMIT
[0m18:15:36.025538 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:36.025724 [debug] [MainThread]: On master: Close
[0m18:15:36.025905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:36.026032 [debug] [MainThread]: Connection 'model.data_lab_new.silver_transform' was properly closed.
[0m18:15:36.026171 [info ] [MainThread]: 
[0m18:15:36.026324 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:15:36.026630 [debug] [MainThread]: Command end result
[0m18:15:36.041738 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/davidhe/data-lab-new/target/manifest.json
[0m18:15:36.043920 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/davidhe/data-lab-new/target/semantic_manifest.json
[0m18:15:36.054161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/davidhe/data-lab-new/target/run_results.json
[0m18:15:36.054303 [info ] [MainThread]: 
[0m18:15:36.054508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:36.054656 [info ] [MainThread]: 
[0m18:15:36.054822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:15:36.056270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.672307, "process_in_blocks": "0", "process_kernel_time": 0.201058, "process_mem_max_rss": "148897792", "process_out_blocks": "0", "process_user_time": 0.973051}
[0m18:15:36.056446 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:36.056411 after 0.67 seconds
[0m18:15:36.056615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109515ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e43d0>]}
[0m18:15:36.056779 [debug] [MainThread]: Flushing usage events
[0m18:15:37.172571 [debug] [MainThread]: An error was encountered while trying to flush usage events
